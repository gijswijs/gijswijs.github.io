<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content=""><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/ms-icon-144x144.png><meta name=theme-color content=#ffffff><title>Posts for lightning network</title><link href=/styles/main.css rel=stylesheet><link rel=alternate type=application/rss+xml title="Gijs van Dam" href=/rss.xml><link rel=webmention href=https://webmention.io/www.gijsvandam.nl/webmention><link rel=pingback href=https://webmention.io/www.gijsvandam.nl/xmlrpc><link rel=authorization_endpoint href=https://janos-githubproxy.azurewebsites.net/api/authorize/gijswijs/gijswijs.github.io><link rel=token_endpoint href=https://janos-githubproxy.azurewebsites.net/api/token/gijswijs/gijswijs.github.io><link rel=microsub href=https://aperture.p3k.io/microsub/636><link rel=micropub href=https://janos-githubproxy.azurewebsites.net/api/micropub/gijswijs/gijswijs.github.io></head><body class=tag><header>Gijs van Dam<nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/research title=Research>Research</a></li><li><a href=/open-source title="Open Source">Open Source</a></li><li><a href=/ventures title=Ventures>Ventures</a></li><li><a href=/resume title=Resume>Resume</a></li><li><a href=/about title=About>About</a></li><li><a href=/now title=Now>Now</a></li><li><a href=/contact title=Contact>Contact</a></li></ul></nav></header><main><ul><li><article><header><h1><a href=/post/the-effect-of-multi-part-payments-on-the-balance-disovery-attack>The effect of multi-part payments on the Balance Disovery Attack</a></h1><span><a class=u-url href=/topics/lightning-network/index.html><time class=dt-published datetime=2023-09-22T00:00:00Z>September 22, 2023</time></a> <span class=reading-time>8 minute read</span></span><ul><li><a class=p-category href=/topics/pss/ >PSS</a></li><li><a class=p-category href=/topics/lightning-network/ >lightning network</a></li><li><a class=p-category href=/topics/mpp/ >MPP</a></li><li><a class=p-category href=/topics/bda/ >BDA</a></li></ul></header><section><p>My PhD research is mainly on the Balance Discovery Attack (BDA). The BDA was introduced (in academia) by <a href=https://doi.org/10.1145/3321705.3329812 title="On the Difficulty of Hiding the Balance of Lightning Network Channels (2019)">Herrera-Joancomart√≠ et al.</a>. In their paper they used the term balance discovery attack and balance disclosure attack interchangeably. Nowadays the term probing or probing attack is more commonly used, but I prefer BDA, so I&#39;ll keep using that while shouting at the clouds.</p><p>The BDA is an attack on privacy. It can be used to discover balances of payment channels, but when used over a longer period of time it can also be used to detect actual payments. These are things we want to keep private, so it is interesting to look at ways of preventing this data from being leaked. Multi-part payments, and more specifically Payments Split &amp; Switch (PSS) has some surprising effects that can prevent data from being leaked in ways that I will try to explain in this post.</p></section></article></li><li><article><header><h1><a href=/post/all-types-of-multi-part-payments-in-lightning-network-explained>All types of multi-part payments in Lightning Network explained</a></h1><span><a class=u-url href=/topics/lightning-network/index.html><time class=dt-published datetime=2023-09-15T00:00:00Z>September 15, 2023</time></a> <span class=reading-time>10 minute read</span></span><ul><li><a class=p-category href=/topics/pss/ >PSS</a></li><li><a class=p-category href=/topics/lightning-network/ >lightning network</a></li><li><a class=p-category href=/topics/bitcoin/ >bitcoin</a></li><li><a class=p-category href=/topics/mpp/ >MPP</a></li><li><a class=p-category href=/topics/amp/ >AMP</a></li></ul></header><section><p>Lightning Network uses source-based routing. What that means is that the sender is responsible for finding a route to the payee. But because the sender doesn&#39;t know the balances of all channels along a possible route, the proposed route can fail for lack of liquidity. So the sender is forced to try routes until it stumbles upon one that has enough liquidity to relay the payment; it&#39;s a process of trial and error. To increase the likelihood of success the idea of splitting up a payments into smaller parts was floated early on in the development of Lightning Network. The idea was that multiple smaller payments were more likely to succeed than one big payment. But you still want all separate parts of such a payment to act as one single atomic payment, that either succeeds completely or doesn&#39;t succeed at all.</p></section></article></li><li><article><header><h1><a href=/post/why-does-signature-half-aggregation-break-adaptor-signatures>Why does signature half aggregation break adaptor signatures?</a></h1><span><a class=u-url href=/topics/lightning-network/index.html><time class=dt-published datetime=2022-04-04T00:00:00Z>April 4, 2022</time></a> <span class=reading-time>6 minute read</span></span><ul><li><a class=p-category href=/topics/cryptography/ >cryptography</a></li><li><a class=p-category href=/topics/lightning-network/ >lightning network</a></li><li><a class=p-category href=/topics/bitcoin/ >bitcoin</a></li></ul></header><section><p>There is this cool trick you can do with Schnorr signatures. It is called Adaptor Signature (AS). An adaptor signature is an extra signature that, combined with the original signature, allow for revealing a value that was previously hidden. You can use this trick to solve trust problems as they appear in atomic swaps, coin swaps and Discreet Log Contracts (DLCs).</p><p>Signature Aggregation (SA) is a way to aggregate multiple signatures into a single signature. The single aggregate signature is smaller (in bytes) than the original signatures combined. It reduces transaction weight, meaning we can have more transactions per block, which is always a good thing. It&#39;s like 7zip for transactions. Signature <em>Half</em> Aggregation is a variant of SA that only aggregates half of each signature. It offers less compression, but it has the benefit of not requiring any interaction with the signers, whereas full aggregation does require cooperation of all the signers.</p><p>So two cool tricks, but the latter breaks the former when it is used for blockwide signature aggregation. This article explains the math behind it and why SA breaks AS</p></section></article></li><li><article><header><h1><a href=/post/how-do-payments-in-lightning-network-work>How do payments in Lightning Network work?</a></h1><span><a class=u-url href=/topics/lightning-network/index.html><time class=dt-published datetime=2022-03-11T00:00:00Z>March 11, 2022</time></a> <span class=reading-time>7 minute read</span></span><ul><li><a class=p-category href=/topics/cryptography/ >cryptography</a></li><li><a class=p-category href=/topics/lightning-network/ >lightning network</a></li><li><a class=p-category href=/topics/bitcoin/ >bitcoin</a></li></ul></header><section><p>Lightning Network is a peer-to-peer payment network that runs on top of the Bitcoin Blockchain. Because it runs on top of the Blockchain it is called a <em>layer-two solution</em>, which groups it together with other solutions that have this property of being built on top of a Blockchain. <em>Layer One</em> is the base layer, where the Blockchain lives. Because of the inherent properties of Layer One, it is impossible to process large amounts of transactions in that layer. The Bitcoin Blockchain can famously process a mere seven transactions per second on average. This constraint was the main impetus for the creation of Layer Two solutions. Lightning Network, being a Layer Two solution, allows for near instant transactions, that can easily scale to millions of transactions per second.</p></section></article></li><li><article><header><h1><a href=/post/running-c-lightning-in-simverse-with-plugins>Running c-lightning in Simverse with plugins</a></h1><span><a class=u-url href=/topics/lightning-network/index.html><time class=dt-published datetime=2020-12-02T00:00:00Z>December 2, 2020</time></a> <span class=reading-time>4 minute read</span></span><ul><li><a class=p-category href=/topics/simverse/ >simverse</a></li><li><a class=p-category href=/topics/c-lightning/ >c-lightning</a></li><li><a class=p-category href=/topics/lightning-network/ >lightning network</a></li></ul></header><section><p>The goal is to run c-lightning with plugins in a local testing cluster. For my cluster I use <a href=https://github.com/darwin/simverse>Simverse</a>. Simverse allows for additional command line arguments to be passed to <code>lightningd</code>, so it should be possible to run <code>lightningd</code> with the <code>plugin</code> argument.</p><p>Let&#39;s first clone our plugin. We will be using one of the plugins that are available through Lightningd on Github.</p><pre><code>cd ~\simverse\_repos
git clone https://github.com/lightningd/plugins.git --depth 1</code></pre><p>We put the plugin in the <code>_repos</code> folder, because it is assumed that the plugin is there when the cluster is being build. (Also: throughout this article we assume your simverse folder is inside your home folder. If that is not the case, adjust it accordingly)</p><p>Since all nodes in Simverse run inside Docker containers, that plugin-file should be made available inside the Docker context folder. The <code>_repos</code> folder is not part of that context (each container gets its own context) so we have to copy the file from the <code>_repos</code> folder to the Docker context folder. Luckily Simverse works with the concept of recipes. A recipe describes how your cluster should look like. A recipe is a bash script that uses a library called cookbook that can be used to build your cluster step-by-step. Since it is &quot;just&quot; a bash script, you can do anything bash can do to tweak your cluster.</p><p>We will create a recipe that creates a cluster with three c-lightning nodes, running on a bitcoind back-end.</p></section></article></li><li><article><header><h1><a href=/post/debugging-lnd-while-running-a-local-cluster>Debugging LND while running a local cluster</a></h1><span><a class=u-url href=/topics/lightning-network/index.html><time class=dt-published datetime=2020-11-16T00:00:00Z>November 16, 2020</time></a> <span class=reading-time>4 minute read</span></span><ul><li><a class=p-category href=/topics/lnd/ >lnd</a></li><li><a class=p-category href=/topics/simverse/ >simverse</a></li><li><a class=p-category href=/topics/vscode/ >vscode</a></li><li><a class=p-category href=/topics/lightning-network/ >lightning network</a></li></ul></header><section><p>If you want to debug LND, or if you want to take a real deep dive into LND, you probably want to be able to set breakpoints in the source code to see what is actually happening. Not only that, you also want to have the node run in a local cluster of other nodes, so that you can perform some real Lightning actions like opening a channel and make payments. This post takes you through the setup I use based on <a href=https://github.com/go-delve/delve>Delve</a> and <a href=https://github.com/darwin/simverse>Simverse</a>.</p></section></article></li></ul></main><footer><nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/research title=Research>Research</a></li><li><a href=/open-source title="Open Source">Open Source</a></li><li><a href=/ventures title=Ventures>Ventures</a></li><li><a href=/resume title=Resume>Resume</a></li><li><a href=/about title=About>About</a></li><li><a href=/now title=Now>Now</a></li><li><a href=/contact title=Contact>Contact</a></li></ul></nav><ul><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.github.com/gijswijs href=https://www.github.com/gijswijs rel="noreferrer noopener me" target=_blank title=Github>Github</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.linkedin.com/in/gijsvandam/ href=https://www.linkedin.com/in/gijsvandam/ rel="noreferrer noopener me" target=_blank title=LinkedIn>LinkedIn</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.researchgate.net/profile/Gijs_Van_Dam2 href=https://www.researchgate.net/profile/Gijs_Van_Dam2 rel="noreferrer noopener me" target=_blank title=ResearchGate>ResearchGate</a></div></li><li><a href=/feed rel=feed target=_self title=Stream>Stream</a></li><li><a href=/rss.xml rel="" target=_blank title=RSS>RSS</a></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://keybase.io/gijsvandam href=https://keybase.io/gijsvandam rel="noreferrer noopener me" target=_blank title=Keybase>Keybase</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://orcid.org/0000-0002-6188-6859 href=https://orcid.org/0000-0002-6188-6859 rel="noreferrer noopener me" target=_blank title=ORCID>ORCID</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" href="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" rel="noreferrer noopener me" target=_blank title="Google Scholar">Google Scholar</a></div></li></ul><p>&copy; 2023 <a href=/ >Gijs van Dam</a>. Published with <a href=https://github.com/neumannjs/Janos>Janos</a>. Theme <a href=https://github.com/neumannjs/Miksa>Miksa</a>.</p></footer></body><script data-goatcounter=https://gijsvandam.goatcounter.com/count async src=//gc.zgo.at/count.js></script></html>