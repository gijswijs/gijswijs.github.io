<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,shrink-to-fit=no"
    />
    <meta name="description" content="">
    <link rel="shortcut icon" href="/favicon.ico">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
    <title>Why does signature half aggregation break adaptor signatures?</title>
    <style>blockquote{border-left:.3rem solid #ced4da;margin-left:0;margin-right:0;padding:1rem 1.5rem}blockquote *:last-child{margin-bottom:0}code{border-radius:.4rem;font-size:86%;margin:0 .2rem;padding:.2rem .5rem;white-space:nowrap}code,pre{background:#6c757d}pre{border-left:.3rem solid #00f;overflow-y:hidden}pre > code{border-radius:0;display:block;padding:1rem 1.5rem;white-space:pre}hr{border:0;border-top:.1rem solid #6c757d;margin:3rem 0}.container,body{margin:0 auto;max-width:112rem;padding:0 2rem;position:relative;width:100%}.row,main{display:flex;flex-direction:column;padding:0;width:100%}.row.row-no-padding,.row.row-no-padding > .column,main.row-no-padding,main.row-no-padding > .column,main.row-no-padding > article,main.row-no-padding > aside,main.row-no-padding > ul{padding:0}.row.row-wrap,main.row-wrap{flex-wrap:wrap}.row.row-top,main.row-top{align-items:flex-start}.row.row-bottom,main.row-bottom{align-items:flex-end}.row.row-center,main.row-center{align-items:center}.row.row-stretch,main.row-stretch{align-items:stretch}.row.row-baseline,main.row-baseline{align-items:baseline}.row .column,.row main > article,.row main > aside,.row main > ul,main .column,main > article,main > aside,main > ul{display:block;flex:1 1 auto;margin-left:0;max-width:100%;width:100%}.row .column.column-offset-10,.row main > article.column-offset-10,.row main > aside.column-offset-10,.row main > ul.column-offset-10,main .column.column-offset-10,main > article.column-offset-10,main > aside.column-offset-10,main > ul.column-offset-10{margin-left:10%}.row .column.column-offset-20,.row main > article.column-offset-20,.row main > aside.column-offset-20,.row main > ul.column-offset-20,main .column.column-offset-20,main > article.column-offset-20,main > aside.column-offset-20,main > ul.column-offset-20{margin-left:20%}.row .column.column-offset-25,.row main > article.column-offset-25,.row main > aside.column-offset-25,.row main > ul.column-offset-25,main .column.column-offset-25,main > article.column-offset-25,main > aside.column-offset-25,main > ul.column-offset-25{margin-left:25%}.row .column.column-offset-33,.row .column.column-offset-34,.row main > article.column-offset-33,.row main > article.column-offset-34,.row main > aside.column-offset-33,.row main > aside.column-offset-34,.row main > ul.column-offset-33,.row main > ul.column-offset-34,main .column.column-offset-33,main .column.column-offset-34,main > article.column-offset-33,main > article.column-offset-34,main > aside.column-offset-33,main > aside.column-offset-34,main > ul.column-offset-33,main > ul.column-offset-34{margin-left:33.3333%}.row .column.column-offset-40,.row main > article.column-offset-40,.row main > aside.column-offset-40,.row main > ul.column-offset-40,main .column.column-offset-40,main > article.column-offset-40,main > aside.column-offset-40,main > ul.column-offset-40{margin-left:40%}.row .column.column-offset-50,.row main > article.column-offset-50,.row main > aside.column-offset-50,.row main > ul.column-offset-50,main .column.column-offset-50,main > article.column-offset-50,main > aside.column-offset-50,main > ul.column-offset-50{margin-left:50%}.row .column.column-offset-60,.row main > article.column-offset-60,.row main > aside.column-offset-60,.row main > ul.column-offset-60,main .column.column-offset-60,main > article.column-offset-60,main > aside.column-offset-60,main > ul.column-offset-60{margin-left:60%}.row .column.column-offset-66,.row .column.column-offset-67,.row main > article.column-offset-66,.row main > article.column-offset-67,.row main > aside.column-offset-66,.row main > aside.column-offset-67,.row main > ul.column-offset-66,.row main > ul.column-offset-67,main .column.column-offset-66,main .column.column-offset-67,main > article.column-offset-66,main > article.column-offset-67,main > aside.column-offset-66,main > aside.column-offset-67,main > ul.column-offset-66,main > ul.column-offset-67{margin-left:66.6666%}.row .column.column-offset-75,.row main > article.column-offset-75,.row main > aside.column-offset-75,.row main > ul.column-offset-75,main .column.column-offset-75,main > article.column-offset-75,main > aside.column-offset-75,main > ul.column-offset-75{margin-left:75%}.row .column.column-offset-80,.row main > article.column-offset-80,.row main > aside.column-offset-80,.row main > ul.column-offset-80,main .column.column-offset-80,main > article.column-offset-80,main > aside.column-offset-80,main > ul.column-offset-80{margin-left:80%}.row .column.column-offset-90,.row main > article.column-offset-90,.row main > aside.column-offset-90,.row main > ul.column-offset-90,main .column.column-offset-90,main > article.column-offset-90,main > aside.column-offset-90,main > ul.column-offset-90{margin-left:90%}.row .column.column-10,.row main > article.column-10,.row main > aside.column-10,.row main > ul.column-10,main .column.column-10,main > article.column-10,main > aside.column-10,main > ul.column-10{flex:0 0 10%;max-width:10%}.row .column.column-20,.row main > article.column-20,.row main > aside.column-20,.row main > ul.column-20,main .column.column-20,main > article.column-20,main > aside.column-20,main > ul.column-20{flex:0 0 20%;max-width:20%}.row .column.column-25,.row main > article.column-25,.row main > aside.column-25,.row main > ul.column-25,main .column.column-25,main > article.column-25,main > aside.column-25,main > ul.column-25{flex:0 0 25%;max-width:25%}.row .column.column-33,.row .column.column-34,.row main > article.column-33,.row main > article.column-34,.row main > aside.column-33,.row main > aside.column-34,.row main > ul.column-33,.row main > ul.column-34,main .column.column-33,main .column.column-34,main > article.column-33,main > article.column-34,main > aside.column-33,main > aside.column-34,main > ul.column-33,main > ul.column-34{flex:0 0 33.3333%;max-width:33.3333%}.row .column.column-40,.row main > article.column-40,.row main > aside.column-40,.row main > ul.column-40,main .column.column-40,main > article.column-40,main > aside.column-40,main > ul.column-40{flex:0 0 40%;max-width:40%}.row .column.column-50,.row main > article.column-50,.row main > aside.column-50,.row main > ul.column-50,main .column.column-50,main > article.column-50,main > aside.column-50,main > ul.column-50{flex:0 0 50%;max-width:50%}.row .column.column-60,.row main > article.column-60,.row main > aside.column-60,.row main > ul.column-60,main .column.column-60,main > article.column-60,main > aside.column-60,main > ul.column-60{flex:0 0 60%;max-width:60%}.row .column.column-66,.row .column.column-67,.row main > article.column-66,.row main > article.column-67,.row main > aside.column-66,.row main > aside.column-67,.row main > ul.column-66,.row main > ul.column-67,main .column.column-66,main .column.column-67,main > article.column-66,main > article.column-67,main > aside.column-66,main > aside.column-67,main > ul.column-66,main > ul.column-67{flex:0 0 66.6666%;max-width:66.6666%}.row .column.column-75,.row main > article.column-75,.row main > aside.column-75,.row main > ul.column-75,main .column.column-75,main > article.column-75,main > aside.column-75,main > ul.column-75{flex:0 0 75%;max-width:75%}.row .column.column-80,.row main > article.column-80,.row main > aside.column-80,.row main > ul.column-80,main .column.column-80,main > article.column-80,main > aside.column-80,main > ul.column-80{flex:0 0 80%;max-width:80%}.row .column.column-90,.row main > article.column-90,.row main > aside.column-90,.row main > ul.column-90,main .column.column-90,main > article.column-90,main > aside.column-90,main > ul.column-90{flex:0 0 90%;max-width:90%}.row .column .column-top,main .column .column-top,main > article .column-top,main > aside .column-top,main > ul .column-top{align-self:flex-start}.row .column .column-bottom,main .column .column-bottom,main > article .column-bottom,main > aside .column-bottom,main > ul .column-bottom{align-self:flex-end}.row .column .column-center,main .column .column-center,main > article .column-center,main > aside .column-center,main > ul .column-center{align-self:center}@media (min-width:40rem){.row,main{flex-direction:row;margin-left:-1rem;width:calc(100% + 2rem)}.row .column,.row main > article,.row main > aside,.row main > ul,main .column,main > article,main > aside,main > ul{margin-bottom:inherit;padding:0 1rem}}a{color:#00f;text-decoration:none}a:focus,a:hover{color:#000}dl,ol,ul{list-style:none;margin-top:0;padding-left:0}dl dl,dl ol,dl ul,ol dl,ol ol,ol ul,ul dl,ul ol,ul ul{font-size:90%;margin:1.5rem 0 1.5rem 3rem}ol{list-style:decimal inside}ul{list-style:circle inside}.button,button,dd,dt,li{margin-bottom:1rem}fieldset,input,select,textarea{margin-bottom:1.5rem}blockquote,dl,figure,form,ol,p,pre,table,ul{margin-bottom:2.5rem}table{border-spacing:0;display:block;overflow-x:auto;text-align:left;width:100%}td,th{border-bottom:.1rem solid #f8f8f8;padding:1.2rem 1.5rem}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}@media (min-width:40rem){table{display:table;overflow-x:initial}}b,strong{font-weight:700}p{margin-top:0}h1,h2,h3,h4,h5,h6{font-weight:300;letter-spacing:-.1rem;margin-bottom:2rem;margin-top:0}h1{font-size:4.6rem;line-height:1.2}h2{font-size:3.6rem;line-height:1.25}h3{font-size:2.8rem;line-height:1.3}h4{font-size:2.2rem;letter-spacing:-.08rem;line-height:1.35}h5{font-size:1.8rem;letter-spacing:-.05rem;line-height:1.5}h6{font-size:1.6rem;letter-spacing:0;line-height:1.4}img{max-width:100%}.clearfix:after{clear:both;content:" ";display:table}.float-left{float:left}.float-right{float:right}body{margin:auto;background-color:#fff}*,*:after,*:before{box-sizing:inherit}html{box-sizing:border-box;font-size:62.5%}body{font-family:"PT Serif",serif;font-size:1.6em;font-weight:300;letter-spacing:.01em;line-height:1.6}body,h1,h1 a{color:#000}h1 a{-webkit-text-decoration-line:underline;text-decoration-line:underline;-webkit-text-decoration-skip:ink;text-decoration-skip-ink:auto;text-decoration-thickness:1px}h1 a:hover{color:#000;-webkit-text-decoration-line:none;text-decoration-line:none}.reading-time,main header time,main header ul{text-transform:uppercase}main header ul{font-size:1.6rem;list-style:none;display:inline-flex}main header ul li{margin-right:1rem}main header ul a{color:#6c757d;-webkit-text-decoration-line:underline;text-decoration-line:underline}main header ul a:hover{color:#6c757d;-webkit-text-decoration-line:none;text-decoration-line:none}a:focus,a:hover{color:#00f;text-decoration:underline}p{margin-bottom:1.5rem}code,pre{background:#f8f8f8}pre{border-left:none}main{flex-wrap:wrap}main > article,main > aside,main > ul{flex:0 0 100%;max-width:100%}@media (min-width:80rem){main > ul{flex:0 0 66.6666%;max-width:66.6666%}.home main > ul{padding-right:2rem}main > aside{flex:0 0 33.3333%;max-width:33.3333%;padding-left:2rem}}body > header{font-size:4.6rem;line-height:1.2;font-variant:small-caps;font-weight:700;text-align:center}body > header ul{border-top:1px solid #000}body > footer,nav{font-size:1.8rem;font-weight:400;font-variant:normal;margin:1rem}body > footer ul,nav ul{list-style:none;display:inline-flex;flex-wrap:wrap;text-transform:uppercase;justify-content:center}body > footer ul li,nav ul li{margin:0 1rem;padding-top:1rem}aside h2{color:#000;text-transform:lowercase;font-variant:small-caps;font-size:3rem;margin-bottom:1rem}aside h2:first-of-type{margin-top:15.5px}aside{color:#6c757d}.author-portrait{max-width:40%;height:auto;border-radius:.5rem;float:right;margin-left:.5rem}aside ul{font-size:1.6rem;line-height:1.6rem;text-transform:lowercase;list-style:none;display:inline-flex;flex-wrap:wrap;padding:0}aside ul li{margin-right:1rem}aside ul a{color:#6c757d;-webkit-text-decoration-line:underline;text-decoration-line:underline}aside ul a:hover{color:#6c757d;-webkit-text-decoration-line:none;text-decoration-line:none}body > footer{text-align:center;justify-content:center;border-top:1px solid #ced4da;margin:1.5rem 0 0}body > footer ul{margin-bottom:1rem;text-transform:none;justify-content:center}body > footer ul a{color:#6c757d;-webkit-text-decoration-line:underline;text-decoration-line:underline}body > footer ul a:hover{color:#6c757d;-webkit-text-decoration-line:none;text-decoration-line:none}body > footer body > footer,body > footer nav{margin-bottom:0}.article footer{flex:0 0 66.6666%;max-width:66.6666%;margin:auto}.article-pagination-left{float:left}.article-pagination-right{float:right}.article-pagination{text-transform:uppercase}.home main > ul{list-style:none}.home article .reading-time,.home article time{color:#6c757d;margin-right:3rem}.home article p:first-of-type{margin-top:1rem}.home article header ul{margin:0}.home article header{border-bottom:1px solid #ced4da}.home article header h1{margin-bottom:.5rem}.article h1,.article header{text-align:center}.article article header span{display:inline-block;width:100%}.article article header span .reading-time{display:inline}.article time{margin-right:3rem}.article article header ul li a,.article article header ul li a :hover{color:#000}.article img{max-width:100%;height:auto}figcaption{text-align:center;margin-top:-1.5rem;font-style:italic}@media (min-width:40rem){.article img{max-width:calc(100% - 6rem);height:auto;margin:0 3rem}}@media (min-width:80rem){.article img{max-width:calc(100% - 12rem);height:auto;margin:0 6rem}}.h-entry .p-author img,.h-entry .u-author img{border-radius:.5rem}.h-cite .h-card img.u-photo,.tweet-container .h-card img.u-photo{width:48px;height:48px;margin-right:.75rem}.h-cite .h-card a{font-size:1.3rem;color:#6c757d}.h-cite .h-card a:not(:first-of-type){margin-left:.5rem}.h-cite p,.h-cite ul,.tweet-container p,.tweet-container ul{margin-bottom:.5rem}.h-cite .h-card a.p-name{color:#00f}.tweet{width:550px}.p-author.h-card,.tweet-container{display:flex;width:610px}.metadata{width:610px}.metadata i:not(:first-of-type){margin-left:2rem}.metadata,a.metadata{font-size:1.3rem;color:#6c757d}.metadata a,a.metadata a{color:#6c757d}div.h-entry{border-radius:10px;border:1px solid #6c757d;max-width:620px;margin:auto;padding:5px}ul.h-feed{margin:auto}ul.h-feed,ul.likes,ul.replies,ul.reposts{list-style:none}ul.reposts{width:100%;display:inline-flex;flex-wrap:wrap;margin-bottom:.5rem}ul.reposts:before{visibility:visible;position:relative;height:48px;width:36px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='%236c757d' d='M13 18H6V7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3Cpath stroke='%236c757d' d='M3 9l3-3 3 3M11 6h7v11' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3Cpath stroke='%236c757d' d='M21 15l-3 3-3-3' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E");background-repeat:no-repeat;background-size:28px;background-position:0 10px;content:""}ul.reposts div.p-author.h-card{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;display:flex}ul.reposts a.p-name.u-url{display:none}ul.likes{width:100%;display:inline-flex;flex-wrap:wrap;margin-bottom:.5rem}ul.likes:before{visibility:visible;position:relative;height:48px;width:36px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 488.022 488.022' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%236c757d' d='M471.563 173.778l-145.5-20.8-64.4-132c-8-15.4-30-12.2-35.3 0l-64.4 132-145.6 20.8c-16.4 1-21.6 20.9-10.4 33.2l105 102.9-25 144.5c-2.9 17.8 16.7 27.8 28.1 20.8l129.9-68.6 129.9 67.6c13.6 7 29.8-2.8 28.1-19.7l-25-144.6 105-102.9c12.7-13.5 3.6-31.5-10.4-33.2zm-128.9 114.3c-4.2 5.2-6.2 11.4-5.2 17.7l19.7 116.4-103.9-55.1c-6.7-2.8-13-2.8-18.7 0l-103.9 55.1 19.7-116.4c1-7.3-1-13.5-5.2-17.7l-84.1-82.1 116.4-16.6c6.2-1 11.4-4.2 14.6-10.4l52-105 52 105c3.1 5.2 8.3 9.4 14.6 10.4l116.2 16.6-84.2 82.1z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-size:28px;background-position:0 10px;content:""}ul.likes div.p-author.h-card{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;display:flex}ul.likes a.p-name.u-url{display:none}li.h-cite p.p-content{font-size:1.5rem;padding-left:calc(48px + .75rem);margin-top:calc(-48px + 1.75rem)}ul.replies li.h-cite{margin-top:1rem}ul.replies li.h-cite:not(:last-of-type){border-bottom:#ced4da;border-bottom-width:1px;border-bottom-style:solid}.icon-twitter{display:inline-block;visibility:hidden;position:relative;width:13px}.icon-twitter:after{visibility:visible;position:absolute;top:4px;left:0;height:16px;width:13px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 -15.5 248 232.5' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%236c757d' d='M221.95 51.29c.15 2.17.15 4.34.15 6.53 0 66.73-50.8 143.69-143.69 143.69v-.04c-27.44.04-54.31-7.82-77.41-22.64 3.99.48 8 .72 12.02.73 22.74.02 44.83-7.61 62.72-21.66-21.61-.41-40.56-14.5-47.18-35.07a50.338 50.338 0 0022.8-.87C27.8 117.2 10.85 96.5 10.85 72.46v-.64a50.18 50.18 0 0022.92 6.32C11.58 63.31 4.74 33.79 18.14 10.71a143.333 143.333 0 00104.08 52.76 50.532 50.532 0 0114.61-48.25c20.34-19.12 52.33-18.14 71.45 2.19 11.31-2.23 22.15-6.38 32.07-12.26a50.69 50.69 0 01-22.2 27.93c10.01-1.18 19.79-3.86 29-7.95a102.594 102.594 0 01-25.2 26.16z'/%3E%3C/svg%3E");background-repeat:no-repeat;content:""}.icon-mastodon{display:inline-block;visibility:hidden;position:relative;width:13px}.icon-mastodon:after{visibility:visible;position:absolute;top:4px;left:0;height:16px;width:13px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 216.414 232.01' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%236c757d' d='M211.807 139.088c-3.18 16.366-28.492 34.277-57.562 37.748-15.159 1.809-30.084 3.471-45.999 2.741-26.027-1.192-46.565-6.212-46.565-6.212 0 2.534.156 4.946.469 7.202 3.384 25.687 25.47 27.225 46.391 27.943 21.116.723 39.919-5.206 39.919-5.206l.867 19.09s-14.77 7.931-41.08 9.39c-14.51.797-32.525-.365-53.507-5.919C9.232 213.82 1.406 165.311.209 116.091c-.365-14.613-.14-28.393-.14-39.918 0-50.33 32.976-65.083 32.976-65.083C49.672 3.454 78.204.242 107.865 0h.729c29.66.242 58.21 3.454 74.837 11.09 0 0 32.975 14.752 32.975 65.082 0 0 .414 37.134-4.599 62.916'/%3E%3Cpath fill='%23fff' d='M177.51 80.077v60.941h-24.144v-59.15c0-12.469-5.246-18.797-15.74-18.797-11.602 0-17.417 7.507-17.417 22.352V117.8H96.207V85.423c0-14.845-5.816-22.352-17.418-22.352-10.494 0-15.74 6.328-15.74 18.797v59.15H38.905V80.077c0-12.455 3.171-22.352 9.541-29.675 6.569-7.322 15.171-11.076 25.85-11.076 12.355 0 21.711 4.748 27.898 14.247l6.013 10.082 6.015-10.082c6.185-9.498 15.542-14.247 27.898-14.247 10.677 0 19.28 3.753 25.85 11.076 6.369 7.322 9.54 17.22 9.54 29.675'/%3E%3C/svg%3E");background-repeat:no-repeat;content:""}.icon-reply{display:inline-block;visibility:hidden;position:relative;width:13px}.icon-reply:after{visibility:visible;position:absolute;top:4px;left:0;height:16px;width:13px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 330 330' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%236c757d' d='M315 70h-75V15c0-8.284-6.716-15-15-15H15C6.716 0 0 6.716 0 15v176.333c0 8.284 6.716 15 15 15h21V245a15 15 0 0023.602 12.289L90 236.01v25.324c0 8.284 6.716 15 15 15h92.605l72.793 50.955a14.993 14.993 0 0015.529 1.016A15 15 0 00294 315v-38.667h21c8.284 0 15-6.716 15-15V85c0-8.284-6.716-15-15-15zM66 216.19v-24.856c0-8.284-6.716-15-15-15H30V30h180v40H105c-8.284 0-15 6.716-15 15v114.39l-24 16.8zm234 30.143h-21c-8.284 0-15 6.716-15 15v24.856l-53.064-37.145a14.997 14.997 0 00-8.602-2.711H120V100h180v146.333z'/%3E%3C/svg%3E");background-repeat:no-repeat;content:""}.icon-like{display:inline-block;visibility:hidden;position:relative;width:13px}.icon-like:after{visibility:visible;position:absolute;top:4px;left:0;height:16px;width:13px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 488.022 488.022' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%236c757d' d='M471.563 173.778l-145.5-20.8-64.4-132c-8-15.4-30-12.2-35.3 0l-64.4 132-145.6 20.8c-16.4 1-21.6 20.9-10.4 33.2l105 102.9-25 144.5c-2.9 17.8 16.7 27.8 28.1 20.8l129.9-68.6 129.9 67.6c13.6 7 29.8-2.8 28.1-19.7l-25-144.6 105-102.9c12.7-13.5 3.6-31.5-10.4-33.2zm-128.9 114.3c-4.2 5.2-6.2 11.4-5.2 17.7l19.7 116.4-103.9-55.1c-6.7-2.8-13-2.8-18.7 0l-103.9 55.1 19.7-116.4c1-7.3-1-13.5-5.2-17.7l-84.1-82.1 116.4-16.6c6.2-1 11.4-4.2 14.6-10.4l52-105 52 105c3.1 5.2 8.3 9.4 14.6 10.4l116.2 16.6-84.2 82.1z'/%3E%3C/svg%3E");background-repeat:no-repeat;content:""}.icon-repost{display:inline-block;visibility:hidden;position:relative;width:13px}.icon-repost:after{visibility:visible;position:absolute;top:4px;left:0;height:16px;width:13px;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='%236c757d' d='M13 18H6V7' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3Cpath stroke='%236c757d' d='M3 9l3-3 3 3M11 6h7v11' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3Cpath stroke='%236c757d' d='M21 15l-3 3-3-3' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' fill='none'/%3E%3C/svg%3E");background-repeat:no-repeat;content:""}article ul.likes img.u-photo,article ul.replies img.u-photo,article ul.reposts img.u-photo{max-width:unset;margin:0 .75rem 0 0}article div.metadata,article ul.likes,article ul.replies,article ul.reposts{width:unset;max-width:66.6666%;margin-left:16.6666%}
</style>
    <link rel="alternate" type="application/rss+xml" title="Gijs van Dam" href="/rss.xml" />
    <link rel="webmention" href="https://webmention.io/www.gijsvandam.nl/webmention" />
    <link rel="pingback" href="https://webmention.io/www.gijsvandam.nl/xmlrpc" />
    
    <link rel="authorization_endpoint" href="https://janos-githubproxy.azurewebsites.net/api/authorize/gijswijs/gijswijs.github.io">
    <link rel="token_endpoint" href="https://janos-githubproxy.azurewebsites.net/api/token/gijswijs/gijswijs.github.io">
    
    <link rel="microsub" href="https://aperture.p3k.io/microsub/636">
    <link rel="micropub" href="https://janos-githubproxy.azurewebsites.net/api/micropub/gijswijs/gijswijs.github.io">
  </head>
  <body class="article h-entry">
    <header>
  Gijs van Dam
  <nav>
  <ul>
      
        
          
        
        <li>
          <a href="/" title="Home">
            Home
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/" title="Home">
            Home
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/research" title="Research">
            Research
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/open-source" title="Open Source">
            Open Source
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/ventures" title="Ventures">
            Ventures
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/resume" title="Resume">
            Resume
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/about" title="About">
            About
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/now" title="Now">
            Now
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/contact" title="Contact">
            Contact
          </a>
        </li>
      
    </ul>
</nav>
</header>
    
  <main>
    <article>
      
        
        <script>
          MathJax = {
            chtml: {
              scale: 1, // global scaling factor for all expressions
              minScale: 1, // smallest scaling factor to use
            }
          };
        </script>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
      <header>
        <h1 class="p-name">Why does signature half aggregation break adaptor signatures?</h1>
        <span>
    <a class="u-url" href="/post/why-does-signature-half-aggregation-break-adaptor-signatures">
    <time class="dt-published" datetime="2022-01-28T00:00:00Z">January 28, 2022</time></a>
    <span class="reading-time">6 minute read</span>
</span>
<ul>
    <li><a class="p-category" href="/topics/cryptography/">cryptography</a></li>
    <li><a class="p-category" href="/topics/lightning-network/">lightning network</a></li>
    <li><a class="p-category" href="/topics/bitcoin/">bitcoin</a></li>
    </ul>   

      </header>
      <section class="e-content">
        <p>There is this cool trick you can do with Schnorr signatures. It is called Adaptor Signature (AS). An adaptor signature is an extra signature that, combined with the original signature, allow for revealing a value that was previously hidden. You can use this trick to solve trust problems as they appear in atomic swaps, coin swaps and Discreet Log Contracts (DLCs).</p>
<p>Signature Aggregation (SA) is a way to aggregate multiple signatures into a single signature. The single aggregate signature is smaller (in bytes) than the original signatures combined. It reduces transaction weight, meaning we can have more transactions per block, which is always a good thing. It&#39;s like 7zip for transactions. Signature <em>Half</em> Aggregation is a variant of SA that only aggregates half of each signature. It offers less compression, but it has the benefit of not requiring any interaction with the signers, whereas full aggregation does require cooperation of all the signers. </p>
<p>So two cool tricks, but the latter breaks the former. This article explains the math behind it and why SA breaks AS</p>
<!-- more -->

<h2 id="schnorr-signatures">Schnorr Signatures</h2>
<p>Let&#39;s start with a normal, vanilla signature, and then work our way up to adaptor signatures. To create a signature we need a public key and a private key. With Schnorr the private key is just an integer value somewhere between \(0\) and \(\sim2^{256}\). Let&#39;s call this private key <em>x</em>. The public key <em>P</em> belonging to <em>x</em> is then a special point on our elliptic curve added to itself <em>x</em> times. This point is called the <em>base point</em> or <em>generator</em>. We assign it the letter <em>G</em>. Adding a point <em>n</em> times to itself is the definition of multiplication, so we can capture our key-pair in this simple formula:</p>
<p>\[P=xG\]</p>
<p>You might be tempted to think that it might be easy to calculate the private key <em>x</em> if you know the public key <em>P</em> and the base point <em>G</em>, because \(x=\frac{P}{G}\). But while addition (and multiplication) over an elliptic curve is easy, division (undoing multiplication) is hard. In fact it is so hard, that it is completely infeasible to calculate the private key, given the public key. This is at the foundation of all elliptic curve cryptography.</p>
<p>Now let&#39;s sign a message with this private key, and validate the signature with the public key. To sign a message we need a <em>challenge</em> and a <em>nonce</em>. A nonce is a random number that we use only one time for signing a single message. We use the letter \(r\) to indicate our nonce. We calculate the public key \(R\) that pairs with \(r\). The challenge is a hash-value that depends on the message we are signing. It all fits together like this:</p>
<p>\[
\begin{align}
R&amp;=rG \\
[e&amp;=H(P||R||m)
\end{align}
\]</p>
<p>The hashing function is indicated by \(H()\) and it is chosen in such a way that it returns a value that of the same scale as our private keys. That is why SHA256 is a great choice for the hashing function. It&#39;s important to understand that a hash is <em>just</em> a number. We can us it as such and do some elliptic curve calculations with it to come up with our signature:</p>
<p>\[s=r + ex\]</p>
<p>The signature is published by the Signer as \((s, R)\). </p>
<p>A Verifier can now verify whether the Signer knows the private key \(x\). It only needs to know \(s\) and \(R\) (the signature) and the public key \(P\) of the signer, which is public by definition. The base point \(G\) is a published property of the elliptic curve. The challenge can be constructed by the verifier as well, since it only uses public information. To verify you have to calculate whether:</p>
<p>\[sG = R + Pe\]</p>
<p>The verification should fail if that equality doesn&#39;t hold.</p>
<p>It is easy to see why this is proof of the Signer knowing \(x\) and having used it to sign \(m\):</p>
<p>\[
\begin{align}
sG &amp;= R + Pe \\
&amp;= rG + xGe \\
&amp;= (r + ex)G
\end{align}
\]</p>
<h2 id="adaptor-signatures">Adaptor Signatures</h2>
<p>Now let&#39;s crank things up a bit and create an adaptor signature. An adaptor signature is a normal Schnorr signature with an added secret tweak. This tweak is the secret we want to hide and only reveal upon revealing the signature. The tweak is indicated by the letter \(t\). Again, we calculate the public key belonging to \(t\) with \(T=tG\). The challenge and the signature are now slightly different because of the tweak:</p>
<p>\[
\begin{align} \\
e&amp;=H(P||R+T||m) \\
s&amp;=r+t+ex
\end{align}
\]</p>
<p>The adaptor signature \(s&#39;\) is the signature minus the secret tweak, so \(s&#39;=s-t\). instead of releasing the signature as we did with the vanilla Schnorr signature, we now published the adaptor signature as \((s&#39;,R,T)\).</p>
<p>The Verifier can still be sure that the Signer owns the secret key \(x\). Remember \(s&#39;=s-t\), so:</p>
<p>\[
\begin{align}
s&#39;&amp;=s-t \\
&amp;=r+t+ex-t \\
&amp;=r+ex
\end{align}
\]</p>
<p>Which means that verification didn&#39;t really change for the Verifier. The Verifier only needs to add \(R\) and \(T\) because of the challenge, but apart from that verification remains the same:</p>
<p>\[s&#39;G = R + Pe\]</p>
<p>And the proof of the correctness is similar as well: </p>
<p>\[
\begin{align}
s&#39;G &amp;= R + Pe \\
&amp;= rG + xGe \\
&amp;= (r + ex)G
\end{align}
\]</p>
<p>When the Verifier receives the untweaked signature \(s\) it can calculate the secret tweak: \(t=s-s&#39;\). Likewise, when the Signer releases the secret tweak, the Verifier can calculate the untweaked signature \(s=s&#39;+t\).</p>
<p>This construction is the building block of things like <a href="https://reyify.com/blog/flipping-the-scriptless-script-on-schnorr">private Coinswap</a>, and Cross-chain Swaps.</p>
<h2 id="signature-half-aggregation">Signature Half Aggregation</h2>
<p>Now, let&#39;s try to understand Signature Half Aggregation. The basic concept of Signature Half Aggregation is to take the \(i\) signatures \((s_{i}, R_{i})\) that we want to aggregate, and then concatenate all the \(R\)-values and sum all the\(s\)-values. But as it turned out, that construction <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-May/014306.html">wasn&#39;t safe</a>. But with a small adjustment we can make a construction that <em>is</em> safe. Instead of summing all the\(s\)-values, we sum up all the\(s\)-values <em>after</em> multiplying them with unpredictable values.</p>
<p>Assume we have \(n\) Schnorr signatures we want to aggregate. For each signature, we create an unpredictable value \(z_{i}\). So, for \(i = 1 .. n\) we calculate the following value:</p>
<p>\[z_{i}=H(P_{1}||R_{1}||m_{1}||...||P_{n}||R_{n}||m_{n}||i)\]</p>
<p>Our aggregate signature now becomes:</p>
<p>\[s_{agg}=\sum_{i=1}^{n}z_{i}s_{i}\]</p>
<p>The signature is published as \((s_{agg}, R_{1}...R_{n})\). It doesn&#39;t have to be one (or all) of the Signers of the original signatures that has to do the aggregation. It can be any third party because this construction is non-interactive. It doesn&#39;t require the cooperation of the Signers after they have published their own signature.</p>
<p>Verification now becomes slightly different, but it is still easy to prove its correctness:</p>
<p>\[
\begin{align}
s_{agg}G = \sum_{i=1}^{n} z_{i}(R_{i}+P_{i}e_{i}) \\
&amp;= \sum_{i=1}^{n} z_{i}(r_{i}G+x_{i}Ge_{i}) \\
&amp;= \sum_{i=1}^{n} z_{i}(r_{i}+x_{i}e_{i})G \\
&amp;= \sum_{i=1}^{n} z_{i}s_{i}G
\end{align}
\]</p>
<h2 id="signature-half-aggregation-breaks-adaptor-signatures">Signature Half Aggregation Breaks Adaptor Signatures</h2>
<p><a href="https://github.com/ElementsProject/cross-input-aggregation/blob/master/slides/2021-Q2-halfagg-impl.org">https://github.com/ElementsProject/cross-input-aggregation/blob/master/slides/2021-Q2-halfagg-impl.org</a>
<a href="https://tlu.tarilabs.com/cryptography/introduction-schnorr-signatures">https://tlu.tarilabs.com/cryptography/introduction-schnorr-signatures</a>
<a href="https://bitcoinops.org/en/topics/adaptor-signatures/">https://bitcoinops.org/en/topics/adaptor-signatures/</a>
<a href="https://medium.com/crypto-garage/adaptor-signature-on-ecdsa-cac148dfa3ad">https://medium.com/crypto-garage/adaptor-signature-on-ecdsa-cac148dfa3ad</a></p>

      </section>
      
      
      
      
      
    </article>
  </main>

    <footer>
  <nav>
  <ul>
      
        
          
        
        <li>
          <a href="/" title="Home">
            Home
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/" title="Home">
            Home
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/research" title="Research">
            Research
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/open-source" title="Open Source">
            Open Source
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/ventures" title="Ventures">
            Ventures
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/resume" title="Resume">
            Resume
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/about" title="About">
            About
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/now" title="Now">
            Now
          </a>
        </li>
      
        
          
        
        <li>
          <a href="/contact" title="Contact">
            Contact
          </a>
        </li>
      
    </ul>
</nav>
  <ul>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://www.github.com/gijswijs" href="https://www.github.com/gijswijs" rel="noreferrer noopener me" target="_blank" title="Github">
            Github
          </a>
        </div>
      
    </li>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://www.linkedin.com/in/gijsvandam/" href="https://www.linkedin.com/in/gijsvandam/" rel="noreferrer noopener me" target="_blank" title="LinkedIn">
            LinkedIn
          </a>
        </div>
      
    </li>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://www.researchgate.net/profile/Gijs_Van_Dam2" href="https://www.researchgate.net/profile/Gijs_Van_Dam2" rel="noreferrer noopener me" target="_blank" title="ResearchGate">
            ResearchGate
          </a>
        </div>
      
    </li>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://bitcoinhackers.org/@gijswijs" href="https://bitcoinhackers.org/@gijswijs" rel="noreferrer noopener me" target="_blank" title="Mastodon">
            Mastodon
          </a>
        </div>
      
    </li>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://www.twitter.com/gijswijs" href="https://www.twitter.com/gijswijs" rel="noreferrer noopener me" target="_blank" title="Twitter">
            Twitter
          </a>
        </div>
      
    </li>
    
    
    
      
    
    <li>
      
        <a href="/feed" rel="feed" target="_self" title="Stream">
          Stream
        </a>
      
    </li>
    
    
    
    <li>
      
        <a href="/rss.xml" rel="" target="_blank" title="RSS">
          RSS
        </a>
      
    </li>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://keybase.io/gijsvandam" href="https://keybase.io/gijsvandam" rel="noreferrer noopener me" target="_blank" title="Keybase">
            Keybase
          </a>
        </div>
      
    </li>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://orcid.org/0000-0002-6188-6859" href="https://orcid.org/0000-0002-6188-6859" rel="noreferrer noopener me" target="_blank" title="ORCID">
            ORCID
          </a>
        </div>
      
    </li>
    
    
    
    <li>
      
        
        <div itemscope itemtype="https://schema.org/Person">
          <a itemprop="sameAs" content="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" href="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" rel="noreferrer noopener me" target="_blank" title="Google Scholar">
            Google Scholar
          </a>
        </div>
      
    </li>
    
  </ul>
  <p>
    &copy; 2022
    <a href="/">Gijs van Dam</a>.
      Published with <a href="https://github.com/neumannjs/Janos">Janos</a>.
      Theme <a href="https://github.com/neumannjs/Miksa">Miksa</a>.
  </p>
</footer>
  </body>
  <script data-goatcounter="https://gijsvandam.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</html>
