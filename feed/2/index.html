<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="Gijs van Dam is a freelance consultant and crypto researcher with over 20 years of international experience, who tries to make the web a better place."><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/ms-icon-144x144.png><meta name=theme-color content=#ffffff><title>Gijs van Dam</title><link href=/styles/main.css rel=stylesheet><link rel=alternate type=application/rss+xml title="Gijs van Dam" href=/rss.xml><link rel=webmention href=https://webmention.io/www.gijsvandam.nl/webmention><link rel=pingback href=https://webmention.io/www.gijsvandam.nl/xmlrpc><link rel=authorization_endpoint href=https://janos-githubproxy.azurewebsites.net/api/authorize/gijswijs/gijswijs.github.io><link rel=token_endpoint href=https://janos-githubproxy.azurewebsites.net/api/token/gijswijs/gijswijs.github.io><link rel=microsub href=https://aperture.p3k.io/microsub/636><link rel=micropub href=https://janos-githubproxy.azurewebsites.net/api/micropub/gijswijs/gijswijs.github.io></head><body class=stream><header>Gijs van Dam<nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/research title=Research>Research</a></li><li><a href=/open-source title="Open Source">Open Source</a></li><li><a href=/ventures title=Ventures>Ventures</a></li><li><a href=/resume title=Resume>Resume</a></li><li><a href=/about title=About>About</a></li><li><a href=/now title=Now>Now</a></li><li><a href=/contact title=Contact>Contact</a></li></ul></nav></header><main><ul class=h-feed><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a> <a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div><a href=/photo/2022/03/31-13008><img src=https://www.gijsvandam.nl/stream/2022/3/31/RackMultipart20220331-4-zaeoik.jpg class=u-photo></a></div></div><div class=metadata><i class=icon-repost>&nbsp;</i> 1 repost <i class=icon-like>&nbsp;</i> 4 likes</div><div class=metadata><a href=/photo/2022/03/31-13008 class=u-url><time class=dt-published datetime=2022-03-31T03:36:48Z>2022-03-31 03:36:48 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1509374469999153158 class="u-syndication icon-twitter">twitter</a> <a href=https://bitcoinhackers.org/@gijswijs/108049065268989759 class="u-syndication icon-mastodon">mastodon</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Oof. Man, you certainly fell into a shitshow. Good luck!</p><a href=https://brid.gy/publish/twitter></a> <a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a> <a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/03/31-9522 class=u-url><time class=dt-published datetime=2022-03-31T02:38:42Z>2022-03-31 02:38:42 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/03/30-48948 class=u-url><time class=dt-published datetime=2022-03-30T13:35:48Z>2022-03-30 13:35:48 +00:00</time> </a><a href=https://twitter.com/JeremyRubin/status/1508830630338973698 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/03/30-22753 class=u-url><time class=dt-published datetime=2022-03-30T06:19:13Z>2022-03-30 06:19:13 +00:00</time> </a><a href=https://mastodon.social/@fribbledom/108034220663448066#favorited-by-184567 class="u-syndication icon-mastodon">mastodon</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/03/30-18850 class=u-url><time class=dt-published datetime=2022-03-30T05:14:10Z>2022-03-30 05:14:10 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content></div></div></div><div class=metadata><a href=/like/2022/03/30-14429 class=u-url><time class=dt-published datetime=2022-03-30T04:00:29Z>2022-03-30 04:00:29 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/03/30-6154 class=u-url><time class=dt-published datetime=2022-03-30T01:42:34Z>2022-03-30 01:42:34 +00:00</time> </a><a href=https://twitter.com/SteveStuWill/status/1508977951043616768 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Say that you are from the US without saying that you are from the US.ðŸ¤£</p></div></div></div><div class=metadata><a href=/reply/2022/03/29-47144 class=u-url><time class=dt-published datetime=2022-03-29T13:05:44Z>2022-03-29 13:05:44 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content></div></div></div><div class=metadata><a href=/like/2022/03/29-45901 class=u-url><time class=dt-published datetime=2022-03-29T12:45:01Z>2022-03-29 12:45:01 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content></div></div></div><div class=metadata><a href=/like/2022/03/29-44443 class=u-url><time class=dt-published datetime=2022-03-29T12:20:43Z>2022-03-29 12:20:43 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>phd students right now... #wikipediadown</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a> <a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div><a href=/photo/2022/03/29-24484><img src=https://www.gijsvandam.nl/stream/2022/3/29/phd-anxiety.jpg alt="PhD wikipedia anxiety" class=u-photo></a></div></div><div class=metadata><i class=icon-like>&nbsp;</i> 3 likes</div><div class=metadata><a href=/photo/2022/03/29-24484 class=u-url><time class=dt-published datetime=2022-03-29T06:48:04Z>2022-03-29 06:48:04 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1508697807800221702 class="u-syndication icon-twitter">twitter</a> <a href=https://bitcoinhackers.org/@gijswijs/108038492296555453 class="u-syndication icon-mastodon">mastodon</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>timeouts, but they are gone now. Maybe something network related. Thanks for the quick reply tho!</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/03/24-25808 class=u-url><time class=dt-published datetime=2022-03-24T07:10:08Z>2022-03-24 07:10:08 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1506891413958672388 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>@aaronpk I&#39;m integrating webmentions in my website, using webmentions.io and I might have crashed your server. Although I don&#39;t think I ddos-ed it with more than a 1000 requests. Anyway, if it was me, I am so sorry.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><i class=icon-reply>&nbsp;</i> 2 replies</div><div class=metadata><a href=/note/2022/03/24-25322 class=u-url><time class=dt-published datetime=2022-03-24T07:02:02Z>2022-03-24 07:02:02 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1506889372578332674 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>But you <em>can</em> drag &amp; drop PDFs into your collection which achieves almost the same thing. Some quirks still require getting used to, but I&#39;m happy so far. @zotero couldn&#39;t have timed this release any better. Also importing from Mendeley was a breeze. Bye bye @mendeley_com.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><i class=icon-repost>&nbsp;</i> 1 repost</div><div class=metadata><a href=/reply/2022/03/19-20011 class=u-url><time class=dt-published datetime=2022-03-19T05:33:31Z>2022-03-19 05:33:31 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1505055135357190147 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>6.0 just came out of beta! <a href=https://www.zotero.org/blog/zotero-6/ >https://www.zotero.org/blog/zotero-6/</a> I jumped into the deep end, and <em>switched</em>. @zotero 6.0 has a PDF reader, which was the main thing holding me back. Renaming, bibtex sync, deduplication all works out of the gate or with plugins. Only thing missing: watch folder</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/03/19-19572 class=u-url><time class=dt-published datetime=2022-03-19T05:26:12Z>2022-03-19 05:26:12 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1505053325401763847 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Maybe now is the time to switch to @zotero? The things missing from @mendeley_com Reference Manager can be handled with Zotero plugins afaik.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><i class=icon-repost>&nbsp;</i> 1 repost <i class=icon-reply>&nbsp;</i> 2 replies</div><div class=metadata><a href=/reply/2022/03/18-6287 class=u-url><time class=dt-published datetime=2022-03-18T01:44:47Z>2022-03-18 01:44:47 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1504635208448024577 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div><a href=/reply/2022/03/15-27609><img src=https://www.gijsvandam.nl/stream/2022/3/15/GUMMBAH_P_Do-you-want-to-whine.gif alt="Do you want to whine about it or solve it? Whine about it." class=u-photo></a></div></div><div class=metadata><i class=icon-like>&nbsp;</i> 3 likes</div><div class=metadata><a href=/reply/2022/03/15-27609 class=u-url><time class=dt-published datetime=2022-03-15T07:40:09Z>2022-03-15 07:40:09 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1503637463151132674 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>The @mendeley_com Reference Manager is a step backwards from Mendeley Desktop. Wrapping your web app in @electronjs and market it as &quot;efficient, flexible and responsive&quot; just isn&#39;t cutting it. Stuff missing at first glance:</p><ul><li>watched folders</li><li>rename files</li><li>BibTeX syncing</li></ul><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><i class=icon-repost>&nbsp;</i> 1 repost <i class=icon-like>&nbsp;</i> 2 likes <i class=icon-reply>&nbsp;</i> 4 replies</div><div class=metadata><a href=/note/2022/03/15-8786 class=u-url><time class=dt-published datetime=2022-03-15T02:26:26Z>2022-03-15 02:26:26 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1503558547140972547 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>I have such a weak spot for communist architecture of that era.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><i class=icon-like>&nbsp;</i> 1 like</div><div class=metadata><a href=/reply/2022/03/14-3524 class=u-url><time class=dt-published datetime=2022-03-14T00:58:44Z>2022-03-14 00:58:44 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1503174067750424577 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<h1 class=p-name>How do payments in Lightning Network work?</h1><div class=e-content><p>Lightning Network is a peer-to-peer payment network that runs on top of the Bitcoin Blockchain. Because it runs on top of the Blockchain it is called a <em>layer-two solution</em>, which groups it together with other solutions that have this property of being built on top of a Blockchain. <em>Layer One</em> is the base layer, where the Blockchain lives. Because of the inherent properties of Layer One, it is impossible to process large amounts of transactions in that layer. The Bitcoin Blockchain can famously process a mere seven transactions per second on average. This constraint was the main impetus for the creation of Layer Two solutions. Lightning Network, being a Layer Two solution, allows for near instant transactions, that can easily scale to millions of transactions per second.</p><p>Lightning Network uses Bitcoin transactions, just like &quot;vanilla&quot; Bitcoin transactions in Layer One. This means that the underlying trust assumptions of Bitcoin are not forfeited by Lightning Network. The consensus model of Bitcoin isn&#39;t impacted either, so in that sense Lightning Network offers plain ol&#39; Bitcoin transactions, but with the goodness of instantaneity and near infinite scalability.</p><p>So what&#39;s the trick that Lightning Network uses to make this possible? Well, participants of Lightning Network transact with each other by means of exchanging Bitcoin transactions that <em>could</em> be broadcasted to the Blockchain (like a normal Bitcoin transaction) but in practice rarely ever <em>have</em> to be broadcasted to the Blockchain. So the vast majority of the transactions in Lightning Network will never hit the Blockchain, and aren&#39;t bogged down by waiting times for transactions being broadcasted, or high transaction fees.</p><h2 id=payment-channels>Payment Channels</h2><p>Lightning Network employs a concept called <em>Payment Channel</em> to make this trick possible. A Payment Channel is a channel between two participants in the Lightning Network. A channel is opened by a <em>funding transaction</em>. This determines the total amount of money in the channel, aka the channel capacity. The two participants at either end of the channel can now transact with each other. You can think of the channel as an abacus or counting frame with only one row of beads that connects the two participants. Transactions are now done by sliding beads up and down the abacus to either side, representing the transaction amounts.</p><div id=scene1></div><div class=controls1><button>Play</button></div><p>Every time beads are pushed from one side to another, a new Bitcoin transaction is created that represents the new balance of the channel. Each transactions spends the funding transaction and divides the funding amount according to the balance of the payment channel. But those transactions are not broadcasted to the Blockchain if the channel is to remain open. So, a Payment Channel is at its core a set of consecutive Bitcoin transactions. The latest transaction added to the set represents the current state of the channel. So in the case of the animation above, the latest state of the channel would be represented by a Bitcoin transaction that would spend the funding of 5 beads into three beads for Bob and two beads for Alice.</p><p>Both participants have their own copy of those Bitcoin transactions. They can broadcast the latest state of the channel to the Blockchain whenever they feel like it. They can do this either in consultation with each other (called a cooperative close) or unilaterally. This broadcast of the latest state is called the closing of the channel. After this the channel is defunct, and no more transactions can take place.</p><p>In principle there is nothing that keeps a node from broadcasting an old state. In the example above Alice might be tempted to broadcast the first state of the channel, in which she would receive five beads (and Bob zero), instead of the latest state in which she would receive two beads and Bob three. To disincentivize broadcasting old states, Lightning Network has a very smart penalty system, that allows Bob to punish Alice when she broadcasts an old state. The punishment is simple and harsh, namely the perp loses all funds, which are then funneled to the maligned party. The ins and outs of that penalty system will be a topic for another blog post.</p><h2 id=multi-hop-payments>Multi-hop Payments</h2><p>Lightning Network has a second feature that drastically reduces the amount of transactions that need to be broadcasted to the Blockchain: Multi-hop payments. In Lightning Network you don&#39;t need to open up a channel with every party that you want to transact with. You can transact with every node as long as there is a payment route from you to that node. So if we extend our network consisting of Alice and Bob, with a third node, Carol and a channel between her and Bob, Alice is able to transact with Carol without the need for opening up a direct channel with Carol. A channel not opened is a funding transaction not having to be broadcasted to the blockchain, so this is the second</p><div id=scene2></div><div class=controls2><button>Play</button></div><p>So long as Alice is able to find a route to Carol, and the balances along that route are sufficient for the amount of the payment (in this case the balance at Alice&#39;s side in the channel between her and Bob, and the balance at Bob&#39;s side in the channel between him and Carol) the payment can go through. But how can we trust Bob that he will forward our payment to Carol? Why wouldn&#39;t he be tempted to collect the payment from Alice to him and just keep the money? We set out stating that the underlying trust assumptions of Bitcoin are not affected by Lightning Network, so we can&#39;t just introduce trust in a system that is supposed to be trustless. We can&#39;t trust Bob on his blue eyes, or whatever color they might be. This is where HTLC&#39;s come in, the final piece of Bitcoin trickery that makes payments in Lightning Network possible.</p><h2 id=htlcs>HTLC&#39;s</h2><p>HTLC&#39;s is what makes payments in Lightning Network trustless. HTLC stands for <em>Hashed TimeLock Contracts</em>. To understand how an HTLC works we maybe need to take a step back and look at how a basic Bitcoin transaction works. In the above examples we could think of the transactions as being <em>Pay-to-PubKey-Hash</em> (P2PKH). This is the most common form of payment on the Bitcoin network. It is a payment to a Bitcoin address that can only be spent by the person that controls the corresponding private key. But using P2PKH wouldn&#39;t allow us to make trustless multi-hop payments. To achieve this we need <em>Pay-to-Script-Hash</em> (P2SH), which is way to create <em>custom</em> redeem scripts. A custom redeem script makes it possible to unlock a payment on the basis of something more complex than just controlling the private key belonging to a Bitcoin address.</p><p>The redeem script for an HTLC knows two execution paths. One path encodes the time lock and the other encodes the hash lock. The hash lock path pays out to the <em>receiver</em>. It ensures that the receiver can spend the output of the HTLC under the condition that he can provide the secret value (also called <em>pre-image</em>) used to create the hash. The time lock ensures that the <em>sender</em> of the payment can spend the output of the HTLC after a fixed amount of time. The payer, in our case Alice, chooses the timeout, say 48 hours, but she also needs to create the hash lock. Alice needs to be sure that Carol is the <em>only</em> one that can open the hash lock. To do so she asks Carol to provide her with a hash of a pre-image (the secret value) that only Carol knows. This is the hash that Alice will use for the hash lock. With all the ingredients in place, Alice can now set up a payment to Carol.</p><div id=scene3></div><div class=controls3><button>Play</button></div><p>Alice, having received the hash from Carol, finds a route to Carol. In our network there is only one route to Carol, namely via Bob. Alice now sets up an HTLC with Bob with a timeout of 48 hours for the time lock, and the hash provided by Carol for the hash lock. Bob receives the HTLC <em>and</em> the route of the payment. Reading the route, he knows that he needs to set up a payment with Carol. Now it is time for Bob to set up an HTLC with Carol. He uses <em>the exact same</em> hash for the hash lock, but a timeout that is a few hours shorter than the one Alice granted him. The shorter timeout leaves Bob with enough time to claim his money once he learns the pre-image. Upon receiving the HTLC from Bob, Carol sees from the route that she is the receiver of the payment and she recognizes the hash. Moreover, she knows the secret pre-image belonging to that hash. By unlocking the hash lock, she reveals the pre-image to Bob. Bob, in his turn, can now unlock the HTLC he received from Alice. If for whatever reason Carol fails to reveal the pre-image, the timeouts make sure all the beads would return to their original position, as if no payment ever happened.</p><svg id=sprites xmlns=http://www.w3.org/2000/svg x=0 y=0 width=0 height=0><defs><g id=bubble opacity=0><rect fill=white height=60 rx=5 ry=5 stroke=black stroke-width=0.75 width=200 x=.75 y=13 /><polygon id=pointblack points="5.75,0 15.75,0 10.75,5" fill=black /><polygon id=pointwhite points="6.5,0 15,0 10.75,4.25" fill=white /><text font-size=8 font-family=sans-serif font-weight=bold dominant-baseline=middle fill=black><tspan x=101.5 id=line1 dy=18.75 text-anchor=middle>Line 2</tspan><tspan x=101.5 id=line2 dy=11.5 text-anchor=middle>Line 2</tspan></text></g><svg id=lnNode viewBox="0 0 116 74" width=116 height=74 x=0 y=0><rect x=3 y=3 rx=10 ry=10 width=110 height=68 style="fill: none; stroke: black; stroke-width: 3"/><text font-size=30 font-family=serif fill=black x=50% y=50% dominant-baseline=middle text-anchor=middle>NAME</text></svg> <svg id=lock xmlns=http://www.w3.org/2000/svg viewBox="-12 -12 24 24" width=100 height=100 x=110 opacity=0><path id=shackle d="M 3.5 3 L 3.5 -3 A 3.5 3.5 0 0 0 -3.5 -3 L -3.5 0" stroke=black fill=none stroke-width=1.2 /><rect x=-5 y=0 width=10 height=10 fill=white stroke=black stroke-width=1 /></svg> <svg xmlns=http://www.w3.org/2000/svg viewBox="-12 -12 24 24" x=0 y=0 width=38 height=38 id=hourglass><g transform=rotate(180)><g id=hourglass><defs><clipPath id=myClip><rect x=-12 y=-10 width=24 height=18 /></clipPath></defs><circle id=sandTop cx=0 cy=-10 r=7 stroke=none clip-path=url(#myClip) fill=black /><path id=clip d="M -12 -12 L -2 0 L 2 0 L 12 -12 L 12 12 L -12 12 Z" fill=white stroke=none /><path d="M15.566 11.021A7.016 7.016 0 0 0 19 5V4h1V2H4v2h1v1a7.016 7.016 0 0 0 3.434 6.021c.354.208.566.545.566.9v.158c0 .354-.212.69-.566.9A7.016 7.016 0 0 0 5 19v1H4v2h16v-2h-1v-1a7.014 7.014 0 0 0-3.433-6.02c-.355-.21-.567-.547-.567-.901v-.158c0-.355.212-.692.566-.9zm-1.015 3.681A5.008 5.008 0 0 1 17 19v1H7v-1a5.01 5.01 0 0 1 2.45-4.299c.971-.573 1.55-1.554 1.55-2.622v-.158c0-1.069-.58-2.051-1.551-2.623A5.008 5.008 0 0 1 7 5V4h10v1c0 1.76-.938 3.406-2.449 4.298C13.58 9.87 13 10.852 13 11.921v.158c0 1.068.579 2.049 1.551 2.623z" transform=translate(-12,-12) fill=black /><circle id=sandBottom cx=0 cy=15.5 r=7 stroke=none fill=black /><line id=sandStream x1=0 y1=-9 x2=0 y2=-4 stroke=black stroke-width=2 /><rect x=-12 y=10 width=24 height=14 stroke=none fill=white /></g></g></svg> <svg xmlns=http://www.w3.org/2000/svg viewBox="-12 -12 24 24" x=0 y=0 width=38 height=38 id=numpad><rect id=numpad1 x=-12 y=-12 width=6 height=6 fill=black stroke=none /><rect id=numpad2 x=-3 y=-12 width=6 height=6 fill=black stroke=none /><rect id=numpad3 x=6 y=-12 width=6 height=6 fill=black stroke=none /><rect id=numpad4 x=-12 y=-3 width=6 height=6 fill=black stroke=none /><rect id=numpad5 x=-3 y=-3 width=6 height=6 fill=black stroke=none /><rect id=numpad6 x=6 y=-3 width=6 height=6 fill=black stroke=none /><rect id=numpad7 x=-12 y=6 width=6 height=6 fill=black stroke=none /><rect id=numpad8 x=-3 y=6 width=6 height=6 fill=black stroke=none /><rect id=numpad9 x=6 y=6 width=6 height=6 fill=black stroke=none /></svg></defs></svg></div></div></div><div class=metadata><a href=/post/how-do-payments-in-lightning-network-work class=u-url><time class=dt-published datetime=2022-03-11T00:00:00Z>2022-03-11 00:00:00 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href=https://brid.gy/publish/twitter></a></div></div></div><div class=metadata><a href=/repost/2022/03/07-49678 class=u-url><time class=dt-published datetime=2022-03-07T13:47:58Z>2022-03-07 13:47:58 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href=https://brid.gy/publish/twitter></a></div></div></div><div class=metadata><a href=/repost/2022/03/03-amazing class=u-url><time class=dt-published datetime=2022-03-03T08:18:00Z>2022-03-03 08:18:00 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>The latest vid from @bitluni&#39;s channel is a piece of art. You don&#39;t know it yet, but you <em>want</em> to know more about phased arrays. Go watch the vid. <a href="https://www.youtube.com/watch?v=z4uxC7ISd-c">https://www.youtube.com/watch?v=z4uxC7ISd-c</a></p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a> <a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/note/2022/03/02-30920 class=u-url><time class=dt-published datetime=2022-03-02T08:35:20Z>2022-03-02 08:35:20 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1498940635906248706 class="u-syndication icon-twitter">twitter</a> <a href=https://bitcoinhackers.org/@gijswijs/107886036505188420 class="u-syndication icon-mastodon">mastodon</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Thank you for the kind words. It was a pleasure!</p><p>&lt;cite class=&quot;h-cite u-quotation-of&quot;&gt; &lt;a class=&quot;u-url&quot; href=&quot;<a href=https://twitter.com/edazcona/status/1498721507761172485>https://twitter.com/edazcona/status/1498721507761172485</a>&quot;&gt; Discover more about the security of the Lightning Network! @gijswijs research is extremely valuable for continuously improving the Lightning Network</p><p>Youtube: <a href=https://youtu.be/rVxUGs6S3PI>https://youtu.be/rVxUGs6S3PI</a> BitcoinTV: <a href=https://bitcointv.com/w/of4fPNECsigKk929ejWTBW>https://bitcointv.com/w/of4fPNECsigKk929ejWTBW</a></p><p>#Bitcoin #LightningNetwork @SatoshiRadioPod &lt;/a&gt; &lt;/cite&gt;</p></div></div></div><div class=metadata><i class=icon-like>&nbsp;</i> 4 likes <i class=icon-reply>&nbsp;</i> 1 reply</div><div class=metadata><a href=/note/2022/03/02-5366 class=u-url><time class=dt-published datetime=2022-03-02T01:29:26Z>2022-03-02 01:29:26 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>#javascript #nodejs @webpack</p><a href=https://brid.gy/publish/twitter></a> <a href=https://brid.gy/publish/mastodon></a></div><a href=/photo/2022/02/28-27104><img src=https://www.gijsvandam.nl/stream/2022/2/28/webpack-meme.jpg alt="Setting up webpack debugging in vscode requires human sacrifice" class=u-photo></a></div></div><div class=metadata><i class=icon-repost>&nbsp;</i> 3 reposts</div><div class=metadata><a href=/photo/2022/02/28-27104 class=u-url><time class=dt-published datetime=2022-02-28T07:31:44Z>2022-02-28 07:31:44 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1498199543212609537 class="u-syndication icon-twitter">twitter</a> <a href=https://bitcoinhackers.org/@gijswijs/107874457044321214 class="u-syndication icon-mastodon">mastodon</a></div></div></li><li class=article-pagination><a href=/feed/3 rel=feed class=article-pagination-left>Older posts</a> <a href=/feed class=article-pagination-right>Newer posts</a></li></ul></main><footer><nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/research title=Research>Research</a></li><li><a href=/open-source title="Open Source">Open Source</a></li><li><a href=/ventures title=Ventures>Ventures</a></li><li><a href=/resume title=Resume>Resume</a></li><li><a href=/about title=About>About</a></li><li><a href=/now title=Now>Now</a></li><li><a href=/contact title=Contact>Contact</a></li></ul></nav><ul><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.github.com/gijswijs href=https://www.github.com/gijswijs rel="noreferrer noopener me" target=_blank title=Github>Github</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.linkedin.com/in/gijsvandam/ href=https://www.linkedin.com/in/gijsvandam/ rel="noreferrer noopener me" target=_blank title=LinkedIn>LinkedIn</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.researchgate.net/profile/Gijs_Van_Dam2 href=https://www.researchgate.net/profile/Gijs_Van_Dam2 rel="noreferrer noopener me" target=_blank title=ResearchGate>ResearchGate</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://bitcoinhackers.org/@gijswijs href=https://bitcoinhackers.org/@gijswijs rel="noreferrer noopener me" target=_blank title=Mastodon>Mastodon</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.twitter.com/gijswijs href=https://www.twitter.com/gijswijs rel="noreferrer noopener me" target=_blank title=Twitter>Twitter</a></div></li><li><a href=/feed rel=feed target=_self title=Stream>Stream</a></li><li><a href=/rss.xml rel="" target=_blank title=RSS>RSS</a></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://keybase.io/gijsvandam href=https://keybase.io/gijsvandam rel="noreferrer noopener me" target=_blank title=Keybase>Keybase</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://orcid.org/0000-0002-6188-6859 href=https://orcid.org/0000-0002-6188-6859 rel="noreferrer noopener me" target=_blank title=ORCID>ORCID</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" href="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" rel="noreferrer noopener me" target=_blank title="Google Scholar">Google Scholar</a></div></li></ul><p>&copy; 2022 <a href=/ >Gijs van Dam</a>. Published with <a href=https://github.com/neumannjs/Janos>Janos</a>. Theme <a href=https://github.com/neumannjs/Miksa>Miksa</a>.</p></footer></body><script data-goatcounter=https://gijsvandam.goatcounter.com/count async src=//gc.zgo.at/count.js></script></html>