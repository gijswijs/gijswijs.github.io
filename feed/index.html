<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content="Gijs van Dam is a freelance consultant and crypto researcher with over 20 years of international experience, who tries to make the web a better place."><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/ms-icon-144x144.png><meta name=theme-color content=#ffffff><title>Gijs van Dam</title><link href=/styles/main.css rel=stylesheet><link rel=alternate type=application/rss+xml title="Gijs van Dam" href=/rss.xml><link rel=webmention href=https://webmention.io/www.gijsvandam.nl/webmention><link rel=pingback href=https://webmention.io/www.gijsvandam.nl/xmlrpc><link rel=authorization_endpoint href=https://janos-githubproxy.azurewebsites.net/api/authorize/gijswijs/gijswijs.github.io><link rel=token_endpoint href=https://janos-githubproxy.azurewebsites.net/api/token/gijswijs/gijswijs.github.io><link rel=microsub href=https://aperture.p3k.io/microsub/636><link rel=micropub href=https://janos-githubproxy.azurewebsites.net/api/micropub/gijswijs/gijswijs.github.io></head><body class=stream><header>Gijs van Dam<nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/research title=Research>Research</a></li><li><a href=/open-source title="Open Source">Open Source</a></li><li><a href=/ventures title=Ventures>Ventures</a></li><li><a href=/resume title=Resume>Resume</a></li><li><a href=/about title=About>About</a></li><li><a href=/now title=Now>Now</a></li><li><a href=/contact title=Contact>Contact</a></li></ul></nav></header><main><ul class=h-feed><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Always nice to see that your research is appreciated.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/repost/2022/05/13-24864 class=u-url><time class=dt-published datetime=2022-05-13T06:54:24Z>2022-05-13 06:54:24 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1525006832498094080 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/05/13-24063 class=u-url><time class=dt-published datetime=2022-05-13T06:41:03Z>2022-05-13 06:41:03 +00:00</time> </a><a href=https://twitter.com/SteveStuWill/status/1524898174611378176 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/05/13-21401 class=u-url><time class=dt-published datetime=2022-05-13T05:56:41Z>2022-05-13 05:56:41 +00:00</time> </a><a href=https://twitter.com/doctorow/status/1524803725969195016 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/05/13-6887 class=u-url><time class=dt-published datetime=2022-05-13T01:54:47Z>2022-05-13 01:54:47 +00:00</time> </a><a href=https://twitter.com/SeverinAlexB/status/1522272735837179904 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/05/13-6831 class=u-url><time class=dt-published datetime=2022-05-13T01:53:51Z>2022-05-13 01:53:51 +00:00</time> </a><a href=https://twitter.com/zerofeerouting/status/1522270547492622338 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/05/13-6825 class=u-url><time class=dt-published datetime=2022-05-13T01:53:45Z>2022-05-13 01:53:45 +00:00</time> </a><a href=https://twitter.com/SeverinAlexB/status/1522268266818904065 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/05/13-6753 class=u-url><time class=dt-published datetime=2022-05-13T01:52:33Z>2022-05-13 01:52:33 +00:00</time> </a><a href=https://twitter.com/SeverinAlexB/status/1522260962706870273 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/05/13-6738 class=u-url><time class=dt-published datetime=2022-05-13T01:52:18Z>2022-05-13 01:52:18 +00:00</time> </a><a href=https://twitter.com/SeverinAlexB/status/1522258472397676545 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Waarschijnlijk omdat er een OekraÃ¯ense infiltrant werkzaam was. (<a href=https://www.theverge.com/2022/2/28/22955246/conti-ransomware-russia-ukraine-chat-logs-leaked>https://www.theverge.com/2022/2/28/22955246/conti-ransomware-russia-ukraine-chat-logs-leaked</a>)</p><p>[einde]</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/27-11235 class=u-url><time class=dt-published datetime=2022-04-27T03:07:15Z>2022-04-27 03:07:15 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>...met een diverse groep van medewerkers waarvan het zelfs voor die groepen zelf onduidelijk is in hoeverre die Rusland steunen in hun oorlog. Het grote collectief dat zich expliciet voor de oorlog heeft uitgesproken (Conti) werd twee dagen later zelf gehackt.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/27-11023 class=u-url><time class=dt-published datetime=2022-04-27T03:03:43Z>2022-04-27 03:03:43 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><ol start=3><li>Rusland is voor de Cyber oorlogsvoering deels afhankelijk van hackers collectieven (<a href=https://www.mandiant.com/resources/russia-invasion-ukraine-retaliation>https://www.mandiant.com/resources/russia-invasion-ukraine-retaliation</a>) Deze collectieven kunnen met relatieve immuniteit in en vanuit Rusland opereren, maar zijn in werkelijkheid transnationale entiteiten...</li></ol><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/27-10399 class=u-url><time class=dt-published datetime=2022-04-27T02:53:19Z>2022-04-27 02:53:19 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><ol start=2><li>De noodzaak voor een Cyber War is minder als je al verwikkeld bent in een fysieke oorlog, zeker voor de offensieve partij. Waarom zou je infrastructuur met een onvoorspelbare cyber attack aanvallen, als je het gewoon kapot kan schieten? (<a href=https://spectrum.ieee.org/why-theres-no-real-cyberwar-in-the-ukraine-conflict>https://spectrum.ieee.org/why-theres-no-real-cyberwar-in-the-ukraine-conflict</a> en <a href=https://www.vice.com/en/article/88gbk5/why-we-havent-seen-debilitating-cyberwar-in-ukraine>https://www.vice.com/en/article/88gbk5/why-we-havent-seen-debilitating-cyberwar-in-ukraine</a>)</li></ol><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/27-9703 class=u-url><time class=dt-published datetime=2022-04-27T02:41:43Z>2022-04-27 02:41:43 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><ol><li>De Cyber War is er wel (<a href=https://www.reuters.com/world/europe/exclusive-us-spy-agency-probes-sabotage-satellite-internet-during-russian-2022-03-11/ >https://www.reuters.com/world/europe/exclusive-us-spy-agency-probes-sabotage-satellite-internet-during-russian-2022-03-11/</a>), maar de berichten daarover halen het nieuws niet omdat het ondersneeuwt onder de berichten over raketten op woonwijken en andere oorlogsmisdaden. (<a href=https://www.vice.com/en/article/88gbk5/why-we-havent-seen-debilitating-cyberwar-in-ukraine>https://www.vice.com/en/article/88gbk5/why-we-havent-seen-debilitating-cyberwar-in-ukraine</a>)</li></ol><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/27-9426 class=u-url><time class=dt-published datetime=2022-04-27T02:37:06Z>2022-04-27 02:37:06 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>@jellebc Een kleine aanvulling op de podcast van dag 58 over waarom we (nog) geen cyber war zien in de OekraÃ¯ne. Stellen dat het Westen er goed genoeg op voorbereid was, is een te simplistische weergave van de werkelijkheid. Zoals altijd is het iets genuanceerder...</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/note/2022/04/27-9088 class=u-url><time class=dt-published datetime=2022-04-27T02:31:28Z>2022-04-27 02:31:28 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/04/15-31324 class=u-url><time class=dt-published datetime=2022-04-15T08:42:04Z>2022-04-15 08:42:04 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Cool trick tho! Using the cascading nature of git config, to abuse certain configuration variables that cause Git to execute arbitrary commands.</p><a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/15-30405 class=u-url><time class=dt-published datetime=2022-04-15T08:26:45Z>2022-04-15 08:26:45 +00:00</time> </a><a href=https://bitcoinhackers.org/users/gijswijs/statuses/108135296430346666 class="u-syndication icon-mastodon">mastodon</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/04/12-15596 class=u-url><time class=dt-published datetime=2022-04-12T04:19:56Z>2022-04-12 04:19:56 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>I&#39;m really digging Micropublish.net built by @barryf. It&#39;s stuff like waiting for your note to come online which makes it outperform the &quot;competition&quot;.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div><a href=/photo/2022/04/08-11189><img src=https://raw.githubusercontent.com/gijswijs/gijswijs.github.io/master/stream/2022/4/8/RackMultipart20220408-4-1lvm77g.jpg class=u-photo></a></div></div><div class=metadata><a href=/photo/2022/04/08-11189 class=u-url><time class=dt-published datetime=2022-04-08T03:06:29Z>2022-04-08 03:06:29 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>With the obvious exception of our own tweets. ðŸ˜†</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/08-10065 class=u-url><time class=dt-published datetime=2022-04-08T02:47:45Z>2022-04-08 02:47:45 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>That&#39;s not true for Twitter. That&#39;s just a dumpster fire from the get go. No need to go below the fold.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/reply/2022/04/08-9393 class=u-url><time class=dt-published datetime=2022-04-08T02:36:33Z>2022-04-08 02:36:33 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/like/2022/04/08-9133 class=u-url><time class=dt-published datetime=2022-04-08T02:32:13Z>2022-04-08 02:32:13 +00:00</time></a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>This building is still a place of worship, but now as a mosque. Fully engulfed by the city. <a href="https://www.google.com/maps/@52.3793665,4.8062837,3a,75y,73.24h,100.65t/data=!3m6!1e1!3m4!1sx0v0TVOh9r7xQZKzHBoOpQ!2e0!7i16384!8i8192?hl=en">https://www.google.com/maps/@52.3793665,4.8062837,3a,75y,73.24h,100.65t/data=!3m6!1e1!3m4!1sx0v0TVOh9r7xQZKzHBoOpQ!2e0!7i16384!8i8192?hl=en</a></p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><i class=icon-repost>&nbsp;</i> 1 repost</div><div class=metadata><a href=/reply/2022/04/04-4837 class=u-url><time class=dt-published datetime=2022-04-04T01:20:37Z>2022-04-04 01:20:37 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1510789731776450567 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<h1 class=p-name>Why does signature half aggregation break adaptor signatures?</h1><div class=e-content><p>There is this cool trick you can do with Schnorr signatures. It is called Adaptor Signature (AS). An adaptor signature is an extra signature that, combined with the original signature, allow for revealing a value that was previously hidden. You can use this trick to solve trust problems as they appear in atomic swaps, coin swaps and Discreet Log Contracts (DLCs).</p><p>Signature Aggregation (SA) is a way to aggregate multiple signatures into a single signature. The single aggregate signature is smaller (in bytes) than the original signatures combined. It reduces transaction weight, meaning we can have more transactions per block, which is always a good thing. It&#39;s like 7zip for transactions. Signature <em>Half</em> Aggregation is a variant of SA that only aggregates half of each signature. It offers less compression, but it has the benefit of not requiring any interaction with the signers, whereas full aggregation does require cooperation of all the signers.</p><p>So two cool tricks, but the latter breaks the former when it is used for blockwide signature aggregation. This article explains the math behind it and why SA breaks AS</p><h2 id=schnorr-signatures>Schnorr Signatures</h2><p>Let&#39;s start with a normal, vanilla signature, and then work our way up to adaptor signatures. To create a signature we need a public key and a private key. With Schnorr the private key is just an integer value somewhere between \(0\) and \(\sim2^{256}\). Let&#39;s call this private key <em>x</em>. The public key <em>P</em> belonging to <em>x</em> is then a special point on our elliptic curve added to itself <em>x</em> times. This point is called the <em>base point</em> or <em>generator</em>. We assign it the letter <em>G</em>. Adding a point <em>n</em> times to itself is the definition of multiplication, so we can capture our key-pair in this simple formula:</p><p>\[P=xG\]</p><p>You might be tempted to think that it might be easy to calculate the private key <em>x</em> if you know the public key <em>P</em> and the base point <em>G</em>, because \(x=\frac{P}{G}\). But while addition (and multiplication) over an elliptic curve is easy, division (undoing multiplication) is hard. In fact it is so hard, that it is completely infeasible to calculate the private key, given the public key. This is at the foundation of all elliptic curve cryptography.</p><p>Now let&#39;s sign a message with this private key, and validate the signature with the public key. To sign a message we need a <em>challenge</em> and a <em>nonce</em>. A nonce is a random number that we use only one time for signing a single message. We use the letter \(r\) to indicate our nonce. We calculate the public key \(R\) that pairs with \(r\). The challenge is a hash-value that depends on the message we are signing. It all fits together like this:</p><p>\[ \begin{align} R&amp;=rG \\ e&amp;=H(P||R||m) \end{align} \]</p><p>The hashing function is indicated by \(H()\) and it is chosen in such a way that it returns a value that of the same scale as our private keys. That is why SHA256 is a great choice for the hashing function. It&#39;s important to understand that a hash is <em>just</em> a number. We can us it as such and do some elliptic curve calculations with it to come up with our signature:</p><p>\[s=r + ex\]</p><p>The signature is published by the Signer as \((s, R)\).</p><p>A Verifier can now verify whether the Signer knows the private key \(x\). It only needs to know \(s\) and \(R\) (the signature) and the public key \(P\) of the signer, which is public by definition. The base point \(G\) is a published property of the elliptic curve. The challenge can be constructed by the verifier as well, since it only uses public information. To verify you have to calculate whether:</p><p>\[sG = R + Pe\]</p><p>The verification should fail if that equality doesn&#39;t hold.</p><p>It is easy to see why this is proof of the Signer knowing \(x\) and having used it to sign \(m\):</p><p>\[ \begin{align} sG &amp;= R + Pe \\ &amp;= rG + xGe \\ &amp;= (r + ex)G \end{align} \]</p><h2 id=adaptor-signatures>Adaptor Signatures</h2><p>Now let&#39;s crank things up a bit and create an adaptor signature. An adaptor signature is a normal Schnorr signature with an added secret tweak. This tweak is the secret we want to hide and only reveal upon revealing the signature. The tweak is indicated by the letter \(t\). Again, we calculate the public key belonging to \(t\) with \(T=tG\). The challenge and the signature are now slightly different because of the tweak:</p><p>\[ \begin{align} \\ e&amp;=H(P||R+T||m) \\ s&amp;=r+t+ex \end{align} \]</p><p>The adaptor signature \(s&#39;\) is the signature minus the secret tweak, so \(s&#39;=s-t\). instead of releasing the signature as we did with the vanilla Schnorr signature, we now published the adaptor signature as \((s&#39;,R,T)\).</p><p>The Verifier can still be sure that the Signer owns the secret key \(x\). Remember \(s&#39;=s-t\), so:</p><p>\[ \begin{align} s&#39;&amp;=s-t \\ &amp;=r+t+ex-t \\ &amp;=r+ex \end{align} \]</p><p>Which means that verification didn&#39;t really change for the Verifier. The Verifier only needs to add \(R\) and \(T\) because of the challenge, but apart from that verification remains the same:</p><p>\[s&#39;G = R + Pe\]</p><p>And the proof of the correctness is similar as well:</p><p>\[ \begin{align} s&#39;G &amp;= R + Pe \\ &amp;= rG + xGe \\ &amp;= (r + ex)G \end{align} \]</p><p>When the Verifier receives the untweaked signature \(s\) it can calculate the secret tweak: \(t=s-s&#39;\). Likewise, when the Signer releases the secret tweak, the Verifier can calculate the untweaked signature \(s=s&#39;+t\).</p><p>This construction is the building block of things like <a href=https://reyify.com/blog/flipping-the-scriptless-script-on-schnorr>private Coinswap</a>, and Cross-chain Swaps.</p><h2 id=signature-half-aggregation>Signature Half Aggregation</h2><p>Now, let&#39;s try to understand Signature Half Aggregation. The basic concept of Signature Half Aggregation is to take the \(i\) signatures \((s_{i}, R_{i})\) that we want to aggregate, and then concatenate all the \(R\)-values and sum all the\(s\)-values. But as it turned out, that construction <a href=https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2017-May/014306.html>wasn&#39;t safe</a>. But with a small adjustment we can make a construction that <em>is</em> safe. Instead of summing all the\(s\)-values, we sum up all the\(s\)-values <em>after</em> multiplying them with unpredictable values.</p><p>Assume we have \(n\) Schnorr signatures we want to aggregate. For each signature, we create an unpredictable value \(z_{i}\). So, for \(i = 1 .. n\) we calculate the following value:</p><p>\[z_{i}=H(P_{1}||R_{1}||m_{1}||...||P_{n}||R_{n}||m_{n}||i)\]</p><p>Our aggregate signature now becomes:</p><p>\[s_{agg}=\sum_{i=1}^{n}z_{i}s_{i}\]</p><p>The signature is published as \((s_{agg}, R_{1}...R_{n})\). It doesn&#39;t have to be one (or all) of the Signers of the original signatures that has to do the aggregation. It can be any third party because this construction is non-interactive. It doesn&#39;t require the cooperation of the Signers after they have published their own signature.</p><p>Verification now becomes slightly different, but it is still easy to prove its correctness:</p><p>\[ \begin{align} s_{agg}G &amp;= \sum_{i=1}^{n} z_{i}(R_{i}+P_{i}e_{i}) \\ &amp;= \sum_{i=1}^{n} z_{i}(r_{i}G+x_{i}Ge_{i}) \\ &amp;= \sum_{i=1}^{n} z_{i}(r_{i}+x_{i}e_{i})G \\ &amp;= \sum_{i=1}^{n} z_{i}s_{i}G \end{align} \]</p><h2 id=signature-half-aggregation-breaks-adaptor-signatures>Signature Half Aggregation Breaks Adaptor Signatures</h2><p>So why does Signature Half Agrregation when used for blockwide signature aggregation in Bitcoin break Adaptor Signatures? Well, we need that untweaked signature \(s\) to calculate the secret tweak \(t=s-s&#39;\). But the untweaked signature \(s\) is lost inside the aggregate signature \(s_{agg}\). The only thing we have is the tweaked signature \(s&#39;\), with \(R\) and \(T\), since those were given to us, but the untweaked signature \(s\) should have been revealed when published on-chain. Instead we are given the \(s_{agg}\) which allows us to verify that all inputs inside the block have been signed, but it doesn&#39;t allow us to know the exact value of \(s\).</p><p>And that&#39;s why Signature Half Aggregation breaks Adaptor Signatures.</p></div></div></div><div class=metadata><i class=icon-like>&nbsp;</i> 1 like</div><div class=metadata><a href=/post/why-does-signature-half-aggregation-break-adaptor-signatures class=u-url><time class=dt-published datetime=2022-04-04T00:00:00Z>2022-04-04 00:00:00 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1510918789403398144 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918791940947969 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918794453319681 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918800178561035 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918802615451652 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918807032066052 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918811977129987 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918816905437188 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918821825048582 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918827449626629 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918832319504385 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918837453324293 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918843275018244 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918848580841473 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918851021910018 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918855564328969 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918861646090246 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918864326230016 class="u-syndication icon-twitter">twitter</a> <a href=https://twitter.com/gijswijs/status/1510918866771529729 class="u-syndication icon-twitter">twitter</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><p>Rules to live by. Check out <a href=https://tlu.tarilabs.com/cryptography/elliptic-curves>https://tlu.tarilabs.com/cryptography/elliptic-curves</a> and @tari_labs for some great content on elliptic curve cryptography.</p><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a> <a href="https://brid.gy/publish/mastodon?bridgy_omit_link=true"></a></div><a href=/photo/2022/04/01-6960><img src=https://www.gijsvandam.nl/stream/2022/4/1/RackMultipart20220401-4-93892j.jpg class=u-photo></a></div></div><div class=metadata><a href=/photo/2022/04/01-6960 class=u-url><time class=dt-published datetime=2022-04-01T01:56:00Z>2022-04-01 01:56:00 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1509711582519042048 class="u-syndication icon-twitter">twitter</a> <a href=https://bitcoinhackers.org/@gijswijs/108054332405711629 class="u-syndication icon-mastodon">mastodon</a></div></div></li><li><div class=h-entry><div class=tweet-container><div class="u-author h-card"><a href=/ class=u-url><img src=/images/gijsvandam.jpg alt="Gijs van Dam" class="u-photo p-name"></a></div><div class=tweet>y<div class=e-content><a href="https://brid.gy/publish/twitter?bridgy_omit_link=true"></a></div></div></div><div class=metadata><a href=/repost/2022/04/01-2436 class=u-url><time class=dt-published datetime=2022-04-01T00:40:36Z>2022-04-01 00:40:36 +00:00</time> </a><a href=https://twitter.com/gijswijs/status/1509692496724570118 class="u-syndication icon-twitter">twitter</a></div></div></li><li class=article-pagination><a href=/feed/2 rel=feed class=article-pagination-left>Older posts</a></li></ul></main><footer><nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/research title=Research>Research</a></li><li><a href=/open-source title="Open Source">Open Source</a></li><li><a href=/ventures title=Ventures>Ventures</a></li><li><a href=/resume title=Resume>Resume</a></li><li><a href=/about title=About>About</a></li><li><a href=/now title=Now>Now</a></li><li><a href=/contact title=Contact>Contact</a></li></ul></nav><ul><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.github.com/gijswijs href=https://www.github.com/gijswijs rel="noreferrer noopener me" target=_blank title=Github>Github</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.linkedin.com/in/gijsvandam/ href=https://www.linkedin.com/in/gijsvandam/ rel="noreferrer noopener me" target=_blank title=LinkedIn>LinkedIn</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.researchgate.net/profile/Gijs_Van_Dam2 href=https://www.researchgate.net/profile/Gijs_Van_Dam2 rel="noreferrer noopener me" target=_blank title=ResearchGate>ResearchGate</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://bitcoinhackers.org/@gijswijs href=https://bitcoinhackers.org/@gijswijs rel="noreferrer noopener me" target=_blank title=Mastodon>Mastodon</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.twitter.com/gijswijs href=https://www.twitter.com/gijswijs rel="noreferrer noopener me" target=_blank title=Twitter>Twitter</a></div></li><li><a href=/feed rel=feed target=_self title=Stream>Stream</a></li><li><a href=/rss.xml rel="" target=_blank title=RSS>RSS</a></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://keybase.io/gijsvandam href=https://keybase.io/gijsvandam rel="noreferrer noopener me" target=_blank title=Keybase>Keybase</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://orcid.org/0000-0002-6188-6859 href=https://orcid.org/0000-0002-6188-6859 rel="noreferrer noopener me" target=_blank title=ORCID>ORCID</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" href="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" rel="noreferrer noopener me" target=_blank title="Google Scholar">Google Scholar</a></div></li></ul><p>&copy; 2022 <a href=/ >Gijs van Dam</a>. Published with <a href=https://github.com/neumannjs/Janos>Janos</a>. Theme <a href=https://github.com/neumannjs/Miksa>Miksa</a>.</p></footer></body><script data-goatcounter=https://gijsvandam.goatcounter.com/count async src=//gc.zgo.at/count.js></script></html>