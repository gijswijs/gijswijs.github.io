<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content=""><link rel="shortcut icon" href=/favicon.ico><link rel=apple-touch-icon sizes=57x57 href=/apple-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-icon-180x180.png><link rel=icon type=image/png sizes=192x192 href=/android-icon-192x192.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><meta name=msapplication-TileColor content=#ffffff><meta name=msapplication-TileImage content=/ms-icon-144x144.png><meta name=theme-color content=#ffffff><title>Pandoc-filter for highlighting to-dos in LaTeX output</title><link href=/styles/main.css rel=stylesheet></head><body class=article><header>Gijs van Dam<nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/ title=Home>Home</a></li><li><a href=/pages/research title=Research>Research</a></li><li><a href=/pages/opensource title="Open Source">Open Source</a></li><li><a href=/pages/ventures title=Ventures>Ventures</a></li><li><a href=/pages/resume title=Resume>Resume</a></li><li><a href=/pages/about title=About>About</a></li><li><a href=/pages/now title=Now>Now</a></li><li><a href=/pages/contact title=Contact>Contact</a></li></ul></nav></header><main><article><header><h1>Pandoc-filter for highlighting to-dos in LaTeX output</h1><span><time datetime=2021-02-23>February 23, 2021</time> <span class=reading-time>2 minute read</span></span><ul><li><a href=/topics/pandoc/ >pandoc</a></li><li><a href=/topics/lua/ >lua</a></li><li><a href=/topics/boilerplate-paper/ >boilerplate paper</a></li><li><a href=/topics/latex/ >LaTeX</a></li></ul></header><section><p>While writing my papers I try not to get bogged down too much. So if a paragraph doens&#39;t flow right I just type <code>TODO: rewrite</code> on the line below it, and continue writing. When I think of something that I shouldn&#39;t forget, like an extra analysis to run I just write it down as a todo in the running text of my paper. I also write thoughts on my paper as a todo. Ideas on structure, whether I should maybe rearrange paragraphs or approach a subject differently, it all ends up as a todo in the running text.</p><p>When running the VSCode task for converting my paper to PDF (using Pandoc) it puts all the todos into the running text. That&#39;s fine by me, it helps as an extra reminder that stuff still needs to happen. But I wanted the todos to be visually different from the running text, so that it stands apart and doesn&#39;t confuse people who are reading my draft. That is where my Pandoc filter comes into play.</p><p>While working inside VSCode I keep track off all todo&#39;s with the <a href="https://marketplace.visualstudio.com/items?itemName=Gruntfuggly.todo-tree">Todo Tree</a> extension. This extension searches your workspace for comment tags like TODO and FIXME, and displays them in a tree view in the explorer pane.</p><p><picture><source srcset="/images/todo-tree_s.avif 461w,/images/todo-tree_m.avif 692w,/images/todo-tree_l.avif 922w" type=image/avif><source srcset="/images/todo-tree_s.webp 461w,/images/todo-tree_m.webp 692w,/images/todo-tree_l.webp 922w" type=image/webp><img srcset="/images/todo-tree_s.jpg 461w,/images/todo-tree_m.jpg 692w,/images/todo-tree_l.jpg 922w" src=/images/todo-tree_s.jpg alt="Todo Tree in VSCode" title=/images/todo-tree.jpg loading=lazy decoding=async width=922 height=480><figcaption>/images/todo-tree.jpg</figcaption></picture></p><p>But to keep track of the todo&#39;s when the paper is converted to PDF I created a Pandoc filter that highlights all comments in LaTeX output formats. It is really simple:</p><pre><code class=language-lua>if FORMAT:match &#39;latex&#39; then
    function Para(el)
        if pandoc.utils.equals(pandoc.Str &#39;TODO:&#39;, el.content[1]) then 
            table.insert(el.content, 1, pandoc.RawInline(&#39;latex&#39;, &#39;\\hl{&#39;))
            table.insert(el.content, pandoc.RawInline(&#39;latex&#39;, &#39;}&#39;))
        end
        return el
    end
end</code></pre><p>The only prerequisite is that you put the <code>soul</code> package in the preamble of your LaTeX, because that is the package used for the highlighting. So somewhere in your preamble you should put this:</p><pre><code class=language-latex>\usepackage{soul}</code></pre><p>Now, if you output the paper, the todos are highlighted.</p><p><picture><source srcset="/images/todo-in-pdf_s.avif 540w,/images/todo-in-pdf_m.avif 810w,/images/todo-in-pdf_l.avif 1080w" type=image/avif><source srcset="/images/todo-in-pdf_s.webp 540w,/images/todo-in-pdf_m.webp 810w,/images/todo-in-pdf_l.webp 1080w" type=image/webp><img srcset="/images/todo-in-pdf_s.jpg 540w,/images/todo-in-pdf_m.jpg 810w,/images/todo-in-pdf_l.jpg 1080w" src=/images/todo-in-pdf_s.jpg alt="Todo in LaTeX PDF output" title="Todo in LaTeX PDF output" loading=lazy decoding=async width=1080 height=270><figcaption>Todo in LaTeX PDF output</figcaption></picture></p></section></article></main><footer><nav><ul><li><a href=/ title=Home>Home</a></li><li><a href=/ title=Home>Home</a></li><li><a href=/pages/research title=Research>Research</a></li><li><a href=/pages/opensource title="Open Source">Open Source</a></li><li><a href=/pages/ventures title=Ventures>Ventures</a></li><li><a href=/pages/resume title=Resume>Resume</a></li><li><a href=/pages/about title=About>About</a></li><li><a href=/pages/now title=Now>Now</a></li><li><a href=/pages/contact title=Contact>Contact</a></li></ul></nav><ul><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.github.com/gijswijs href=https://www.github.com/gijswijs rel="noreferrer noopener me" target=_blank title=Github>Github</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.linkedin.com/in/gijsvandam/ href=https://www.linkedin.com/in/gijsvandam/ rel="noreferrer noopener me" target=_blank title=LinkedIn>LinkedIn</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.researchgate.net/profile/Gijs_Van_Dam2 href=https://www.researchgate.net/profile/Gijs_Van_Dam2 rel="noreferrer noopener me" target=_blank title=ResearchGate>ResearchGate</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://bitcoinhackers.org/@gijswijs href=https://bitcoinhackers.org/@gijswijs rel="noreferrer noopener me" target=_blank title=Mastodon>Mastodon</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://www.twitter.com/gijswijs href=https://www.twitter.com/gijswijs rel="noreferrer noopener me" target=_blank title=Twitter>Twitter</a></div></li><li><a href=/rss.xml rel="" target=_blank title=RSS>RSS</a></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://keybase.io/gijsvandam href=https://keybase.io/gijsvandam rel="noreferrer noopener me" target=_blank title=Keybase>Keybase</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content=https://orcid.org/0000-0002-6188-6859 href=https://orcid.org/0000-0002-6188-6859 rel="noreferrer noopener me" target=_blank title=ORCID>ORCID</a></div></li><li><div itemscope itemtype=https://schema.org/Person><a itemprop=sameAs content="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" href="https://scholar.google.com/citations?user=4dTcK4kAAAAJ&amp;hl=en" rel="noreferrer noopener me" target=_blank title="Google Scholar">Google Scholar</a></div></li></ul><p>&copy; 2021 <a href=/ >Gijs van Dam</a>. Published with <a href=https://github.com/neumannjs/Janos>Janos</a>. Theme <a href=https://github.com/neumannjs/Miksa>Miksa</a>.</p></footer></body></html>